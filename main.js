(()=>{"use strict";var e={baseUrl:"https://nomoreparties.co/v1/wff-cohort-2",headers:{authorization:"29e47ff3-c405-4d45-9bbb-503bd9191003","Content-Type":"application/json"}},t=function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))};function n(n){var r="".concat(e.baseUrl,"/cards/likes/").concat(n);return fetch(r,{method:"PUT",headers:e.headers}).then(t)}function r(n){var r="".concat(e.baseUrl,"/cards/likes/").concat(n);return fetch(r,{method:"DELETE",headers:e.headers}).then(t)}function o(e,t,n,r,o){var c=document.getElementById("card-template").content.firstElementChild.cloneNode(!0),a=c.querySelector(".card__title"),i=c.querySelector(".card__image"),u=c.querySelector(".card__like-count"),s=c.querySelector(".card__like-button"),l=c.querySelector(".card__delete-button");a.textContent=e.name,i.src=e.link,i.alt=e.name,u.textContent=e.likes.length;var d=e.likes.some((function(e){return e._id===o}));s.classList.toggle("card__like-button_is-active",d),s.addEventListener("click",(function(){n(s,u,e._id,o)}));var p=e._id;return u.textContent=e.likes.length,o===e.owner._id?l.addEventListener("click",(function(){t(c,p)})):l.style.display="none",i.addEventListener("click",(function(){r(c,i)})),c}function c(e,t,o,c){(e.classList.contains("card__like-button_is-active")?r:n)(o).then((function(n){localStorage.setItem("like_".concat(o),JSON.stringify(n.likes)),e.classList.toggle("card__like-button_is-active",n.likes.some((function(e){return e._id===c}))),t.textContent=n.likes.length})).catch((function(e){console.error("Ошибка лайка:",e)}))}function a(e,n){(function(e){return fetch("https://nomoreparties.co/v1/wff-cohort-2/cards/".concat(e),{method:"DELETE",headers:{authorization:"29e47ff3-c405-4d45-9bbb-503bd9191003"}}).then(t)})(n).then((function(){e.remove()})).catch((function(e){console.error("Ошибка удаления карточки:",e)}))}function i(e){e.classList.add("popup_is-animated"),e.classList.add("popup_is-opened"),document.addEventListener("keydown",s),document.addEventListener("click",l)}function u(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",s),document.removeEventListener("click",l)}var s=function(e){"Escape"===e.code&&u(document.querySelector(".popup_is-opened"))},l=function(e){var t=e.target;t.classList.contains("popup_is-opened")&&u(t)};function d(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);n.forEach((function(n){p(e,n,t)})),r&&_(r,t)}function p(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));r.textContent="",r.classList.remove(n.errorClass),t.classList.remove(n.inputErrorClass)}function f(e,t,n){e.every((function(e){return e.validity.valid}))?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):_(t,n)}function _(e,t){e.classList.add(t.inactiveButtonClass),e.disabled=!0}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=document.querySelector(".popup_type_edit"),y=document.querySelector(".popup_type_new-card"),h=document.querySelector(".popup_type_image"),b=document.querySelector(".popup_type_avatar"),S=v.querySelector(".popup__form"),C=y.querySelector(".popup__form"),q=b.querySelector(".popup__form"),E=document.querySelector(".profile__edit-button"),L=document.querySelectorAll(".popup__close"),g=document.querySelector(".profile__add-button"),k=document.querySelector(".popup__image"),x=document.querySelector(".popup__caption"),A=document.querySelector(".profile__image");A.addEventListener("click",(function(){i(b)}));var w=document.querySelector(".places__list"),j={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function O(e,t){i(h);var n=e.querySelector(".card__title");k.src=t.src,x.textContent=n.textContent,h.src=t.src,h.alt=n.textContent}!function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);d(e,t),n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){if(t.validity.patternMismatch){var r=t.dataset.errorMessage||t.validationMessage;""===t.value.trim()?t.setCustomValidity(""):t.setCustomValidity(r)}else t.setCustomValidity("");t.validity.valid?p(e,t,n):function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));o.textContent=n,o.classList.add(r.errorClass),t.classList.add(r.inputErrorClass)}(e,t,t.validationMessage,n)}(e,o,t),f(n,r,t)}))})),e.addEventListener("reset",(function(){d(e,t)})),f(n,r,t)}(t,e)}))}(j),L.forEach((function(e){e.addEventListener("click",(function(){u(e.closest(".popup"))}))})),E.addEventListener("click",(function(){i(v),d(S,j),U.value=T.textContent,I.value=B.textContent;var e=S.querySelector(".popup__button");e.removeAttribute("disabled"),e.classList.remove("popup__button_disabled")}));var U=S.querySelector(".popup__input_type_name"),I=S.querySelector(".popup__input_type_description"),T=document.querySelector(".profile__title"),B=document.querySelector(".profile__description");U.value=T.textContent,I.value=B.textContent,Promise.all([fetch("".concat(e.baseUrl,"/users/me"),{headers:e.headers}).then(t),fetch("".concat(e.baseUrl,"/cards"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))]).then((function(e){var t,n,r,i,u,s,l,d=(l=2,function(e){if(Array.isArray(e))return e}(s=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,a,i=[],u=!0,s=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return i}}(s,l)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(s,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=d[0],f=d[1];window.userInfo=p,T.textContent=p.name,B.textContent=p.about,A.style.backgroundImage="url(".concat(p.avatar,")"),w.innerHTML="",t=f,n=a,r=c,i=O,u=p._id,t.forEach((function(e){var t=o(e,n,r,i,u);w.appendChild(t)}))})).catch((function(e){console.error("Произошла ошибка:",e)})),S.addEventListener("submit",(function(n){n.preventDefault();var r,o,c=S.querySelector(".popup__button");c.textContent="Сохранение...",(r=U.value,o=I.value,fetch("".concat(e.baseUrl,"/users/me"),{method:"PATCH",headers:e.headers,body:JSON.stringify({name:r,about:o})}).then(t)).then((function(e){T.textContent=e.name,B.textContent=e.about})).finally((function(){c.textContent="Сохранить"})),u(v),d(S,j)})),g.addEventListener("click",(function(){i(y),C.reset(),d(C,j)})),C.addEventListener("submit",(function(n){n.preventDefault();var r,i,s=n.target,l=new FormData(s),d=Object.fromEntries(l),p=d["place-name"],f=d.link,_=C.querySelector(".popup__button");_.textContent="Сохранение...",(r=p,i=f,fetch("".concat(e.baseUrl,"/cards"),{method:"POST",headers:e.headers,body:JSON.stringify({name:r,link:i})}).then(t)).then((function(e){var t=o(e,a,c,O,userInfo._id);w.prepend(t),s.reset(),u(y)})).catch((function(e){console.error("Ошибка добавления карточки:",e)})).finally((function(){_.textContent="Сохранить"})),u(y)})),document.querySelectorAll(".popup").forEach((function(e){return e.classList.add("popup_is-animated")})),q.addEventListener("submit",(function(n){n.preventDefault();var r=n.target.querySelector(".popup__input_type_avatar-url").value,o=q.querySelector(".popup__button");o.textContent="Сохранение...",function(n){return fetch("".concat(e.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:e.headers,body:JSON.stringify({avatar:n})}).then(t)}(r).then((function(){A.style.backgroundImage="url(".concat(r,")"),u(b),q.reset()})).catch((function(e){console.error("Ошибка обновления аватара:",e)})).finally((function(){o.textContent="Сохранить"}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q2lJLEdBQzNCLE9BQU92SixNQUFNLEdBQURMLE9BQUlWLEVBQU9DLFFBQU8sb0JBQW9CLENBQ2hEZSxPQUFRLFFBRVJkLFFBQVNGLEVBQU9FLFFBRWhCd0osS0FBTTlGLEtBQUtDLFVBQVUsQ0FBRXlGLE9BQVFnQixNQUM5QnJKLEtBQUtiLEVBQ1YsQ0k4SEVtSyxDQUFhRCxHQUNWckosTUFBSyxXQUNKa0csRUFBVy9ELE1BQU1pRyxnQkFBa0IsT0FBSDNJLE9BQVU0SixFQUFVLEtBQ3BENUYsRUFBV2dDLEdBQ1hHLEVBQWUrQyxPQUNqQixJQUNDOUYsT0FBTSxTQUFBQyxHQUNMQyxRQUFRRCxNQUFNLDZCQUE4QkEsRUFDOUMsSUFDQzRGLFNBQVEsV0FDUGYsRUFBV3ZHLFlBQWMsV0FDM0IsR0FDSixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9hcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9jYXJkLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvbW9kYWwuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGJhc2VVcmw6ICdodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2ZmLWNvaG9ydC0yJyxcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246ICcyOWU0N2ZmMy1jNDA1LTRkNDUtOWJiYi01MDNiZDkxOTEwMDMnLFxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgfVxufVxuXG5jb25zdCBoYW5kbGVSZXNwb25zZSA9IChyZXMpID0+IHtcbiAgaWYgKHJlcy5vaykge1xuICAgIHJldHVybiByZXMuanNvbigpO1xuICB9XG4gIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0SW5pdGlhbENhcmRzID0gKCkgPT4ge1xuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXG4gIH0pXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IHVwZGF0ZVVzZXJJbmZvID0gKG5hbWUsIGFib3V0KSA9PiB7XG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgYWJvdXQgfSlcbiAgfSkudGhlbihoYW5kbGVSZXNwb25zZSk7XG59XG5cbmV4cG9ydCBjb25zdCBnZXRVc2VySW5mbyA9ICgpID0+IHtcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVyc1xuICB9KS50aGVuKGhhbmRsZVJlc3BvbnNlKTtcbn1cblxuZXhwb3J0IGNvbnN0IHBvc3RDYXJkID0gKG5hbWUsIGxpbmspID0+IHtcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBuYW1lLFxuICAgICAgbGlua1xuICAgIH0pXG4gIH0pLnRoZW4oaGFuZGxlUmVzcG9uc2UpO1xufVxuXG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZEZyb21TZXJ2ZXIgPSAoY2FyZElkKSA9PiB7XG4gIHJldHVybiBmZXRjaChgaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3dmZi1jb2hvcnQtMi9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICBoZWFkZXJzOiB7XG4gICAgICBhdXRob3JpemF0aW9uOiAnMjllNDdmZjMtYzQwNS00ZDQ1LTliYmItNTAzYmQ5MTkxMDAzJ1xuICAgIH1cbiAgfSkudGhlbihoYW5kbGVSZXNwb25zZSk7XG59O1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBwb3N0TGlrZShjYXJkSWQpIHtcbiAgY29uc3QgYXBpVXJsID0gYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWA7XG4gIHJldHVybiBmZXRjaChhcGlVcmwsIHtcbiAgICBtZXRob2Q6ICdQVVQnLFxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXG4gIH0pLnRoZW4oaGFuZGxlUmVzcG9uc2UpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlTGlrZShjYXJkSWQpIHtcbiAgY29uc3QgYXBpVXJsID0gYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWA7XG4gIHJldHVybiBmZXRjaChhcGlVcmwsIHtcbiAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXG4gIH0pLnRoZW4oaGFuZGxlUmVzcG9uc2UpO1xufVxuXG5leHBvcnQgY29uc3QgdXBkYXRlQXZhdGFyID0gKGF2YXRhckxpbmspID0+IHtcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgbWV0aG9kOiAnUEFUQ0gnLFxuXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXG5cbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogYXZhdGFyTGluayB9KVxuICB9KS50aGVuKGhhbmRsZVJlc3BvbnNlKTtcbn0iLCJcbmltcG9ydCB7IGRlbGV0ZUNhcmRGcm9tU2VydmVyLCBwb3N0TGlrZSwgZGVsZXRlTGlrZSB9IGZyb20gXCIuL2FwaVwiO1xuXG4vLyDQpNGD0L3QutGG0LjRjyDRgdC+0LfQtNCw0L3QuNGPINC60LDRgNGC0L7Rh9C60LhcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEsIGRlbGV0ZUNhbGxiYWNrLCB0b29nbGVIZWFydENhbGxiYWNrLCBvcGVuQmlnSW1hZ2VDYWxsYmFjaywgb3duZXJJZCkge1xuICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FyZC10ZW1wbGF0ZScpO1xuICBjb25zdCBuZXdDYXJkID0gY2FyZFRlbXBsYXRlLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQuY2xvbmVOb2RlKHRydWUpO1xuXG4gIGNvbnN0IHRpdGxlQ2FyZGVsID0gbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKTtcbiAgY29uc3QgcGhvdG9DYXJkRWwgPSBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gIGNvbnN0IGxpa2VDb3VudEVsZW1lbnQgPSBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50Jyk7XG4gIGNvbnN0IGxpa2VIZWFydCA9IG5ld0NhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgY29uc3QgZGVsZXRlSWNvbiA9IG5ld0NhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKTtcblxuICB0aXRsZUNhcmRlbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgcGhvdG9DYXJkRWwuc3JjID0gZGF0YS5saW5rO1xuICBwaG90b0NhcmRFbC5hbHQgPSBkYXRhLm5hbWU7XG5cbiAgbGlrZUNvdW50RWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubGlrZXMubGVuZ3RoO1xuXG4gIC8vbGlrZUhlYXJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAvLyAgdG9vZ2xlSGVhcnRDYWxsYmFjayhsaWtlSGVhcnQsIGxpa2VDb3VudEVsZW1lbnQsIGRhdGEuX2lkLCBvd25lcklkKTtcbiAgLy99KTtcblxuXG5cbiAgY29uc3QgaXNMaWtlZEJ5T3duZXIgPSBkYXRhLmxpa2VzLnNvbWUobGlrZSA9PiBsaWtlLl9pZCA9PT0gb3duZXJJZCk7XG4gIGxpa2VIZWFydC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlXCIsIGlzTGlrZWRCeU93bmVyKTtcblxuICBsaWtlSGVhcnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgdG9vZ2xlSGVhcnRDYWxsYmFjayhsaWtlSGVhcnQsIGxpa2VDb3VudEVsZW1lbnQsIGRhdGEuX2lkLCBvd25lcklkKTtcbiAgfSk7XG4gIGNvbnN0IGNhcmRJZCA9IGRhdGEuX2lkO1xuICBsaWtlQ291bnRFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5saWtlcy5sZW5ndGg7XG5cbiAgaWYgKG93bmVySWQgPT09IGRhdGEub3duZXIuX2lkKSB7XG4gICAgZGVsZXRlSWNvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGRlbGV0ZUNhbGxiYWNrKG5ld0NhcmQsIGNhcmRJZCk7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgZGVsZXRlSWNvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICB9XG5cblxuICBwaG90b0NhcmRFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBvcGVuQmlnSW1hZ2VDYWxsYmFjayhuZXdDYXJkLCBwaG90b0NhcmRFbCk7XG4gIH0pO1xuXG4gIHJldHVybiBuZXdDYXJkO1xufVxuXG4vLyDQpNGD0L3QutGG0LjRjyDQvtCx0YDQsNCx0L7RgtC60LAg0LvQsNC50LrQsFxuZXhwb3J0IGZ1bmN0aW9uIHRvb2dsZUhlYXJ0KGhlYXJ0LCBsaWtlQ291bnRFbGVtZW50LCBjYXJkSWQsIG93bmVySWQpIHtcbiAgY29uc3QgaXNMaWtlZCA9IGhlYXJ0LmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZVwiKTtcbiAgY29uc3QgbGlrZU1ldGhvZCA9IGlzTGlrZWQgPyBkZWxldGVMaWtlIDogcG9zdExpa2U7XG5cbiAgbGlrZU1ldGhvZChjYXJkSWQpXG4gICAgLnRoZW4odXBkYXRlZENhcmQgPT4ge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYGxpa2VfJHtjYXJkSWR9YCwgSlNPTi5zdHJpbmdpZnkodXBkYXRlZENhcmQubGlrZXMpKTtcbiAgICAgIGhlYXJ0LmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmVcIiwgdXBkYXRlZENhcmQubGlrZXMuc29tZShsaWtlID0+IGxpa2UuX2lkID09PSBvd25lcklkKSk7XG4gICAgICBsaWtlQ291bnRFbGVtZW50LnRleHRDb250ZW50ID0gdXBkYXRlZENhcmQubGlrZXMubGVuZ3RoO1xuICAgIH0pXG4gICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ9Ce0YjQuNCx0LrQsCDQu9Cw0LnQutCwOicsIGVycm9yKTtcbiAgICB9KTtcbn1cblxuLy8g0KTRg9C90LrRhtC40Y8g0LfQsNCz0YDRg9C30LrQuCDRgdC+0YHRgtC+0Y/QvdC40Y8g0LvQsNC50LrQvtCyINC/0YDQuCDQt9Cw0LPRgNGD0LfQutC1INGB0YLRgNCw0L3QuNGG0YtcbmV4cG9ydCBmdW5jdGlvbiBsb2FkTGlrZXNTdGF0ZShjYXJkSWQsIG93bmVySWQpIHtcbiAgY29uc3Qgc3RvcmVkTGlrZXMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShgbGlrZV8ke2NhcmRJZH1gKTtcblxuICBpZiAoc3RvcmVkTGlrZXMpIHtcbiAgICBjb25zdCBsaWtlcyA9IEpTT04ucGFyc2Uoc3RvcmVkTGlrZXMpO1xuICAgIGNvbnN0IGlzTGlrZWRCeU93bmVyID0gbGlrZXMuc29tZShsaWtlID0+IGxpa2UuX2lkID09PSBvd25lcklkKTtcblxuICAgIHJldHVybiB7IGxpa2VzLCBpc0xpa2VkQnlPd25lciB9O1xuICB9XG5cbiAgcmV0dXJuIHsgbGlrZXM6IFtdLCBpc0xpa2VkQnlPd25lcjogZmFsc2UgfTtcbn1cblxuLy8g0KTRg9C90LrRhtC40Y8g0YPQtNCw0LvQtdC90LjRjyDQutCw0YDRgtC+0YfQutC4XG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgY2FyZElkKSB7XG4gIGRlbGV0ZUNhcmRGcm9tU2VydmVyKGNhcmRJZClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKCfQntGI0LjQsdC60LAg0YPQtNCw0LvQtdC90LjRjyDQutCw0YDRgtC+0YfQutC4OicsIGVycm9yKTtcbiAgICB9KTtcbn0iLCIvL9Ck0YPQvdC60YbQuNGPINC+0YLQutGA0YvRgtC40Y8g0L/QvtC/0LDQv9CwXG5leHBvcnQgZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX2lzLWFuaW1hdGVkJyk7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX2lzLW9wZW5lZCcpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywga2V5RG93bkhhbmRsZXIpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGRvY3VtZW50Q2xpY2tIYW5kbGVyKTtcbn1cbi8v0KTRg9C90LrRhtC40Y8g0LfQsNC60YDRi9GC0LjRjyDQv9C+0L/QsNC/0LBcbmV4cG9ydCBmdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX2lzLW9wZW5lZCcpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywga2V5RG93bkhhbmRsZXIpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGRvY3VtZW50Q2xpY2tIYW5kbGVyKTtcbn1cblxuY29uc3Qga2V5RG93bkhhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgaWYgKGV2ZW50LmNvZGUgPT09IFwiRXNjYXBlXCIpIHtcbiAgICBjb25zdCBvcGVuZWRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9pcy1vcGVuZWQnKTtcbiAgICBjbG9zZU1vZGFsKG9wZW5lZFBvcHVwKTtcbiAgfVxufVxuXG5jb25zdCBkb2N1bWVudENsaWNrSGFuZGxlciA9ICh7IHRhcmdldCB9KSA9PiB7XG4gIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9pcy1vcGVuZWQnKSkge1xuICAgIGNsb3NlTW9kYWwodGFyZ2V0KTtcbiAgfVxufSAiLCJcbmV4cG9ydCBmdW5jdGlvbiBlbmFibGVWYWxpZGF0aW9uKGNvbmZpZykge1xuICBjb25zdCBmb3JtcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XG5cbiAgZm9ybXMuZm9yRWFjaCgoZm9ybSkgPT4ge1xuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtLCBjb25maWcpO1xuICB9KTtcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJWYWxpZGF0aW9uKGZvcm0sIGNvbmZpZykge1xuICBjb25zdCBpbnB1dHMgPSBBcnJheS5mcm9tKGZvcm0ucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xuICBjb25zdCBzdWJtaXRCdXR0b24gPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybSwgaW5wdXQsIGNvbmZpZyk7XG4gIH0pO1xuICBpZiAoc3VibWl0QnV0dG9uKSB7XG4gICAgZGlzYWJsZVN1Ym1pdEJ1dHRvbihzdWJtaXRCdXR0b24sIGNvbmZpZylcbiAgfVxuXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRFdmVudExpc3RlbmVycyhmb3JtLCBjb25maWcpIHtcbiAgY29uc3QgaW5wdXRzID0gQXJyYXkuZnJvbShmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZm9ybS5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIGNsZWFyVmFsaWRhdGlvbihmb3JtLCBjb25maWcpXG4gIGlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKCkge1xuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm0sIGlucHV0LCBjb25maWcpO1xuICAgICAgdG9nZ2xlU3VibWl0QnV0dG9uU3RhdGUoaW5wdXRzLCBzdWJtaXRCdXR0b24sIGNvbmZpZyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcigncmVzZXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgY2xlYXJWYWxpZGF0aW9uKGZvcm0sIGNvbmZpZyk7XG4gIH0pO1xuXG4gIHRvZ2dsZVN1Ym1pdEJ1dHRvblN0YXRlKGlucHV0cywgc3VibWl0QnV0dG9uLCBjb25maWcpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm0sIGlucHV0LCBjb25maWcpIHtcbiAgaWYgKGlucHV0LnZhbGlkaXR5LnBhdHRlcm5NaXNtYXRjaCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGlucHV0LmRhdGFzZXQuZXJyb3JNZXNzYWdlIHx8IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xuXG4gICAgaWYgKGlucHV0LnZhbHVlLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgIGlucHV0LnNldEN1c3RvbVZhbGlkaXR5KCcnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaW5wdXQuc2V0Q3VzdG9tVmFsaWRpdHkoZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaW5wdXQuc2V0Q3VzdG9tVmFsaWRpdHkoJycpO1xuICB9XG5cbiAgaWYgKCFpbnB1dC52YWxpZGl0eS52YWxpZCkge1xuICAgIHNob3dJbnB1dEVycm9yKGZvcm0sIGlucHV0LCBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZSwgY29uZmlnKTtcbiAgfSBlbHNlIHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtLCBpbnB1dCwgY29uZmlnKTtcbiAgfVxufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBzaG93SW5wdXRFcnJvcihmb3JtLCBpbnB1dCwgZXJyb3JNZXNzYWdlLCBjb25maWcpIHtcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuZXJyb3JDbGFzcyk7XG4gIGlucHV0LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoaWRlSW5wdXRFcnJvcihmb3JtLCBpbnB1dCwgY29uZmlnKSB7XG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXQuaWR9LWVycm9yYCk7XG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuZXJyb3JDbGFzcyk7XG4gIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59XG5cbmZ1bmN0aW9uIHRvZ2dsZVN1Ym1pdEJ1dHRvblN0YXRlKGlucHV0cywgc3VibWl0QnV0dG9uLCBjb25maWcpIHtcbiAgY29uc3QgaXNWYWxpZCA9IGlucHV0cy5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcblxuICBpZiAoaXNWYWxpZCkge1xuICAgIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgfSBlbHNlIHtcbiAgICBkaXNhYmxlU3VibWl0QnV0dG9uKHN1Ym1pdEJ1dHRvbiwgY29uZmlnKVxuICB9XG59XG5cblxuZnVuY3Rpb24gZGlzYWJsZVN1Ym1pdEJ1dHRvbihzdWJtaXRCdXR0b24sIGNvbmZpZykge1xuICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG59IiwiaW1wb3J0ICcuL3BhZ2VzL2luZGV4LmNzcyc7XG4vL2ltcG9ydCB7IGluaXRpYWxDYXJkcyB9IGZyb20gJy4vY2FyZHMnO1xuaW1wb3J0IHsgY3JlYXRlQ2FyZCwgdG9vZ2xlSGVhcnQsIGRlbGV0ZUNhcmQsIGxvYWRMaWtlc1N0YXRlIH0gZnJvbSAnLi9jb21wb25lbnRzL2NhcmQnO1xuaW1wb3J0IHsgb3Blbk1vZGFsLCBjbG9zZU1vZGFsIH0gZnJvbSAnLi9jb21wb25lbnRzL21vZGFsJztcbmltcG9ydCB7IGVuYWJsZVZhbGlkYXRpb24sIGNsZWFyVmFsaWRhdGlvbiwgc2V0RXZlbnRMaXN0ZW5lcnMgfSBmcm9tICcuL2NvbXBvbmVudHMvdmFsaWRhdGlvbic7XG5cbmltcG9ydCB7IGdldEluaXRpYWxDYXJkcywgdXBkYXRlVXNlckluZm8sIGdldFVzZXJJbmZvLCBwb3N0Q2FyZCwgZGVsZXRlQ2FyZEZyb21TZXJ2ZXIsIHVwZGF0ZUF2YXRhciB9IGZyb20gJy4vY29tcG9uZW50cy9hcGknO1xuXG4vL0FsbCBtb2RhbCB3aW5kb3cvL1xuY29uc3QgcG9wdXBFZGl0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2VkaXQnKVxuY29uc3QgcG9wdXBBZGRDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfbmV3LWNhcmQnKTtcbmV4cG9ydCBjb25zdCBwb3B1cEltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2ltYWdlJyk7XG5jb25zdCBwb3B1cEVkaXRBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hdmF0YXInKVxuXG4vL0FsbCBmb3JtLy9cbmNvbnN0IGZvcm1FZGl0UHJvZmlsZSA9IHBvcHVwRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJylcbmNvbnN0IGZvcm1BZGRDYXJkID0gcG9wdXBBZGRDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpXG5jb25zdCBmb3JtRWRpdEF2YXRhciA9IHBvcHVwRWRpdEF2YXRhci5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKVxuXG4vL0J1dHRvbnMgb3BlbiAmIGNsb3NlLy9cbmNvbnN0IG9wZW5FZGl0QnRuUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuY29uc3QgY2xvc2VCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19jbG9zZScpO1xuY29uc3Qgb3BlbkJ0bkFkZENhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xuXG5jb25zdCBwb3B1cEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xuY29uc3QgcG9wdXBDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXB0aW9uJyk7XG5cbmNvbnN0IHVzZXJBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1hZ2UnKTtcblxudXNlckF2YXRhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsgb3Blbk1vZGFsKHBvcHVwRWRpdEF2YXRhcikgfSk7XG5cblxuXG5cbi8vIEB0b2RvOiBET00g0YPQt9C70YtcbmNvbnN0IGxpc3RDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VzX19saXN0Jyk7XG5cblxuXG5jb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19idXR0b24nLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX2J1dHRvbl9kaXNhYmxlZCcsXG4gIGlucHV0RXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcbiAgZXJyb3JDbGFzczogJ3BvcHVwX19lcnJvcl92aXNpYmxlJ1xufVxuXG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25Db25maWcpO1xuXG5jbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBjbG9zZU1vZGFsKGJ1dHRvbi5jbG9zZXN0KCcucG9wdXAnKSk7XG4gIH0pO1xufSk7XG5cbi8vIEB0b2RvOiDQpNGD0L3QutGG0LjRjyDQvtC60YLRgNGL0YLQuNGPINC/0L7Qv9Cw0L/QsCDQutCw0YDRgtC40L3QutC4XG5mdW5jdGlvbiBvcGVuQmlnSW1hZ2UobmV3Q2FyZCwgcGhvdG9DYXJkRWwpIHtcbiAgb3Blbk1vZGFsKHBvcHVwSW1nKTtcbiAgY29uc3QgY2FyZFRpdGxlID0gbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKTtcblxuICBwb3B1cEltYWdlLnNyYyA9IHBob3RvQ2FyZEVsLnNyYztcbiAgcG9wdXBDYXB0aW9uLnRleHRDb250ZW50ID0gY2FyZFRpdGxlLnRleHRDb250ZW50O1xuICBwb3B1cEltZy5zcmMgPSBwaG90b0NhcmRFbC5zcmM7XG4gIHBvcHVwSW1nLmFsdCA9IGNhcmRUaXRsZS50ZXh0Q29udGVudDtcbn1cblxuLy8/IEB0b2RvOiDQktGL0LLQtdGB0YLQuCDQutCw0YDRgtC+0YfQutC4INC90LAg0YHRgtGA0LDQvdC40YbRg1xuXG5mdW5jdGlvbiByZW5kZXJDYXJkcyhjYXJkcywgZGVsZXRlQ2FsbGJhY2ssIHRvb2dsZUhlYXJ0Q2FsbGJhY2ssIG9wZW5CaWdJbWFnZUNhbGxiYWNrLCBvd25lcklkKSB7XG4gIC8vINCh0L7Qt9C00LDRjiDQuCDQtNC+0LHQsNCy0LvRj9GOINC60LDRgNGC0L7Rh9C60Lgg0LIg0LrQvtC90YLQtdC50L3QtdGAXG4gIGNhcmRzLmZvckVhY2goZGF0YSA9PiB7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEsIGRlbGV0ZUNhbGxiYWNrLCB0b29nbGVIZWFydENhbGxiYWNrLCBvcGVuQmlnSW1hZ2VDYWxsYmFjaywgb3duZXJJZCk7XG4gICAgLy90b29nbGVIZWFydENhbGxiYWNrKGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpLCBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudCcpLCBkYXRhLl9pZCwgb3duZXJJZCk7XG4gICAgbGlzdENvbnRhaW5lci5hcHBlbmRDaGlsZChjYXJkRWxlbWVudCk7XG4gIH0pO1xufVxuLy8/INCe0YLQutGA0YvRgtC40LUg0Lgg0LfQsNC60YDRi9GC0LjQtSDQv9C+0L/QsNC/0LAgcG9wdXBFZGl0UHJvZmlsZVxub3BlbkVkaXRCdG5Qb3B1cC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgb3Blbk1vZGFsKHBvcHVwRWRpdFByb2ZpbGUpO1xuICBjbGVhclZhbGlkYXRpb24oZm9ybUVkaXRQcm9maWxlLCB2YWxpZGF0aW9uQ29uZmlnKVxuICBuYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbiAgam9iSW5wdXQudmFsdWUgPSBwcm9maWxlSm9iLnRleHRDb250ZW50O1xuXG4gIGNvbnN0IHNhdmVCdXR0b24gPSBmb3JtRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcbiAgc2F2ZUJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gIHNhdmVCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfX2J1dHRvbl9kaXNhYmxlZCcpXG59KTtcblxuLy8/INCd0LDRhdC+0LTQuNC8INC/0L7Qu9GPINGE0L7RgNC80Ysg0LIgRE9NXG5jb25zdCBuYW1lSW5wdXQgPSBmb3JtRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX25hbWUnKTtcbmNvbnN0IGpvYklucHV0ID0gZm9ybUVkaXRQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9kZXNjcmlwdGlvbicpO1xuXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5jb25zdCBwcm9maWxlSm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKVxuXG5uYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbmpvYklucHV0LnZhbHVlID0gcHJvZmlsZUpvYi50ZXh0Q29udGVudDtcblxuXG5Qcm9taXNlLmFsbChbZ2V0VXNlckluZm8oKSwgZ2V0SW5pdGlhbENhcmRzKCldKVxuICAudGhlbigoW3VzZXJJbmZvLCBpbml0aWFsQ2FyZHNdKSA9PiB7XG4gICAgd2luZG93LnVzZXJJbmZvID0gdXNlckluZm87XG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VySW5mby5uYW1lO1xuICAgIHByb2ZpbGVKb2IudGV4dENvbnRlbnQgPSB1c2VySW5mby5hYm91dDtcblxuICAgIHVzZXJBdmF0YXIuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke3VzZXJJbmZvLmF2YXRhcn0pYDtcblxuICAgIGxpc3RDb250YWluZXIuaW5uZXJIVE1MID0gJyc7XG5cbiAgICAvLyDQoNC10L3QtNC10YDQuNC8INC60LDRgNGC0L7Rh9C60LhcbiAgICByZW5kZXJDYXJkcyhpbml0aWFsQ2FyZHMsIGRlbGV0ZUNhcmQsIHRvb2dsZUhlYXJ0LCBvcGVuQmlnSW1hZ2UsIHVzZXJJbmZvLl9pZCk7XG4gICAgLy9yZXR1cm4gZ2V0SW5pdGlhbENhcmRzKClcbiAgfSlcbiAgLmNhdGNoKGVycm9ycyA9PiB7XG4gICAgY29uc29sZS5lcnJvcign0J/RgNC+0LjQt9C+0YjQu9CwINC+0YjQuNCx0LrQsDonLCBlcnJvcnMpO1xuICB9KTtcblxuLy9nZXRVc2VySW5mbygpXG4vLyAgLnRoZW4oKHVzZXJJbmZvKSA9PiB7XG4vLyAgICB3aW5kb3cudXNlckluZm8gPSB1c2VySW5mbztcbi8vICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckluZm8ubmFtZTtcbi8vICAgIHByb2ZpbGVKb2IudGV4dENvbnRlbnQgPSB1c2VySW5mby5hYm91dDtcbi8vICAgIHVzZXJBdmF0YXIudXJsID0gdXNlckluZm8uYXZhdGFyO1xuLy8gICAgcmV0dXJuIGdldEluaXRpYWxDYXJkcygpXG4vLyAgfSlcblxuLy9nZXRJbml0aWFsQ2FyZHMoKVxuLy8gIC50aGVuKGNhcmRzID0+IHtcbi8vICAgIGxpc3RDb250YWluZXIuaW5uZXJIVE1MID0gJyc7IC8vINCe0YfQuNGJ0LDQtdC8INC60L7QvdGC0LXQudC90LXRgCDQv9C10YDQtdC0INC30LDQs9GA0YPQt9C60L7QuSDQvdC+0LLRi9GFINC60LDRgNGC0L7Rh9C10Lpcbi8vICAgIHJlbmRlckNhcmRzKGNhcmRzLCBkZWxldGVDYXJkLCB0b29nbGVIZWFydCwgb3BlbkJpZ0ltYWdlKTtcbi8vICB9KVxuLy8gIC5jYXRjaChlcnJvciA9PiB7XG4vLyAgICBjb25zb2xlLmVycm9yKCfQntGI0LjQsdC60LAg0LfQsNCz0YDRg9C30LrQuCDQutCw0YDRgtC+0YfQtdC6INGBINGB0LXRgNCy0LXRgNCwJywgZXJyb3IpO1xuLy8gIH0pO1xuXG5mb3JtRWRpdFByb2ZpbGUuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGZvcm1FZGl0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbicpO1xuICBzYXZlQnV0dG9uLnRleHRDb250ZW50ID0gJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJztcblxuXG4gIHVwZGF0ZVVzZXJJbmZvKG5hbWVJbnB1dC52YWx1ZSwgam9iSW5wdXQudmFsdWUpXG4gICAgLnRoZW4oKHVzZXJJbmZvKSA9PiB7XG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXJJbmZvLm5hbWU7XG4gICAgICBwcm9maWxlSm9iLnRleHRDb250ZW50ID0gdXNlckluZm8uYWJvdXQ7XG5cbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcblxuICAgICAgc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QuNGC0YwnO1xuICAgIH0pO1xuXG4gIGNsb3NlTW9kYWwocG9wdXBFZGl0UHJvZmlsZSk7XG5cbiAgY2xlYXJWYWxpZGF0aW9uKGZvcm1FZGl0UHJvZmlsZSwgdmFsaWRhdGlvbkNvbmZpZyk7XG5cbn0pO1xuXG5cbm9wZW5CdG5BZGRDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBvcGVuTW9kYWwocG9wdXBBZGRDYXJkKTtcbiAgZm9ybUFkZENhcmQucmVzZXQoKTtcblxuICBjbGVhclZhbGlkYXRpb24oZm9ybUFkZENhcmQsIHZhbGlkYXRpb25Db25maWcpO1xufSlcblxuZm9ybUFkZENhcmQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGZvcm0gPSBldmVudC50YXJnZXQ7XG4gIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGZvcm0pO1xuICBjb25zdCB2YWx1ZXMgPSBPYmplY3QuZnJvbUVudHJpZXMoZm9ybURhdGEpO1xuICBjb25zdCB2YWx1ZU5hbWUgPSB2YWx1ZXNbJ3BsYWNlLW5hbWUnXTtcbiAgY29uc3QgdmFsdWVVcmwgPSB2YWx1ZXNbJ2xpbmsnXTtcblxuICBjb25zdCBzYXZlQnV0dG9uID0gZm9ybUFkZENhcmQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcbiAgc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLic7XG5cbiAgcG9zdENhcmQodmFsdWVOYW1lLCB2YWx1ZVVybClcbiAgICAudGhlbihuZXdDYXJkID0+IHtcblxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKG5ld0NhcmQsIGRlbGV0ZUNhcmQsIHRvb2dsZUhlYXJ0LCBvcGVuQmlnSW1hZ2UsIHVzZXJJbmZvLl9pZCk7XG4gICAgICBsaXN0Q29udGFpbmVyLnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICAgICAgZm9ybS5yZXNldCgpO1xuICAgICAgY2xvc2VNb2RhbChwb3B1cEFkZENhcmQpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ9Ce0YjQuNCx0LrQsCDQtNC+0LHQsNCy0LvQtdC90LjRjyDQutCw0YDRgtC+0YfQutC4OicsIGVycm9yKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcblxuICAgICAgc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QuNGC0YwnO1xuICAgIH0pO1xuXG4gIGNsb3NlTW9kYWwocG9wdXBBZGRDYXJkKTtcblxufSk7XG5cblxuLy/QlNC+0LHQsNCy0LvQtdC90LjQtSDQstGB0LXQvCDQv9C+0L/QsNC/0LDQvCDQutC70LDRgdGB0LAgcG9wdXBfaXMtYW5pbWF0ZWRcbmNvbnN0IGFsbFBvcHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXAnKTtcbmFsbFBvcHMuZm9yRWFjaCgocG9wKSA9PiBwb3AuY2xhc3NMaXN0LmFkZCgncG9wdXBfaXMtYW5pbWF0ZWQnKSlcblxuXG5mb3JtRWRpdEF2YXRhci5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCBhdmF0YXJMaW5rSW5wdXQgPSBldmVudC50YXJnZXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX2F2YXRhci11cmwnKTtcbiAgY29uc3QgYXZhdGFyTGluayA9IGF2YXRhckxpbmtJbnB1dC52YWx1ZTtcbiAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGZvcm1FZGl0QXZhdGFyLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJyk7XG4gIHNhdmVCdXR0b24udGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xuXG4gIHVwZGF0ZUF2YXRhcihhdmF0YXJMaW5rKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIHVzZXJBdmF0YXIuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke2F2YXRhckxpbmt9KWA7XG4gICAgICBjbG9zZU1vZGFsKHBvcHVwRWRpdEF2YXRhcik7XG4gICAgICBmb3JtRWRpdEF2YXRhci5yZXNldCgpXG4gICAgfSlcbiAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcign0J7RiNC40LHQutCwINC+0LHQvdC+0LLQu9C10L3QuNGPINCw0LLQsNGC0LDRgNCwOicsIGVycm9yKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNhdmVCdXR0b24udGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LjRgtGMJztcbiAgICB9KTtcbn0pO1xuXG4iXSwibmFtZXMiOlsiY29uZmlnIiwiYmFzZVVybCIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiaGFuZGxlUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0IiwiY29uY2F0Iiwic3RhdHVzIiwicG9zdExpa2UiLCJjYXJkSWQiLCJhcGlVcmwiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJkZWxldGVMaWtlIiwiY3JlYXRlQ2FyZCIsImRhdGEiLCJkZWxldGVDYWxsYmFjayIsInRvb2dsZUhlYXJ0Q2FsbGJhY2siLCJvcGVuQmlnSW1hZ2VDYWxsYmFjayIsIm93bmVySWQiLCJuZXdDYXJkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImNsb25lTm9kZSIsInRpdGxlQ2FyZGVsIiwicXVlcnlTZWxlY3RvciIsInBob3RvQ2FyZEVsIiwibGlrZUNvdW50RWxlbWVudCIsImxpa2VIZWFydCIsImRlbGV0ZUljb24iLCJ0ZXh0Q29udGVudCIsIm5hbWUiLCJzcmMiLCJsaW5rIiwiYWx0IiwibGlrZXMiLCJsZW5ndGgiLCJpc0xpa2VkQnlPd25lciIsInNvbWUiLCJsaWtlIiwiX2lkIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm93bmVyIiwic3R5bGUiLCJkaXNwbGF5IiwidG9vZ2xlSGVhcnQiLCJoZWFydCIsImNvbnRhaW5zIiwidXBkYXRlZENhcmQiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwiZGVsZXRlQ2FyZCIsImNhcmRFbGVtZW50IiwiZGVsZXRlQ2FyZEZyb21TZXJ2ZXIiLCJyZW1vdmUiLCJvcGVuTW9kYWwiLCJtb2RhbCIsImFkZCIsImtleURvd25IYW5kbGVyIiwiZG9jdW1lbnRDbGlja0hhbmRsZXIiLCJjbG9zZU1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiY29kZSIsIl9yZWYiLCJ0YXJnZXQiLCJjbGVhclZhbGlkYXRpb24iLCJmb3JtIiwiaW5wdXRzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b24iLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImZvckVhY2giLCJpbnB1dCIsImhpZGVJbnB1dEVycm9yIiwiZGlzYWJsZVN1Ym1pdEJ1dHRvbiIsImVycm9yRWxlbWVudCIsImlkIiwiZXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsInRvZ2dsZVN1Ym1pdEJ1dHRvblN0YXRlIiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwicG9wdXBFZGl0UHJvZmlsZSIsInBvcHVwQWRkQ2FyZCIsInBvcHVwSW1nIiwicG9wdXBFZGl0QXZhdGFyIiwiZm9ybUVkaXRQcm9maWxlIiwiZm9ybUFkZENhcmQiLCJmb3JtRWRpdEF2YXRhciIsIm9wZW5FZGl0QnRuUG9wdXAiLCJjbG9zZUJ1dHRvbnMiLCJvcGVuQnRuQWRkQ2FyZCIsInBvcHVwSW1hZ2UiLCJwb3B1cENhcHRpb24iLCJ1c2VyQXZhdGFyIiwibGlzdENvbnRhaW5lciIsInZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsZWN0b3IiLCJvcGVuQmlnSW1hZ2UiLCJjYXJkVGl0bGUiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInBhdHRlcm5NaXNtYXRjaCIsImVycm9yTWVzc2FnZSIsImRhdGFzZXQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInZhbHVlIiwidHJpbSIsInNldEN1c3RvbVZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzZXRFdmVudExpc3RlbmVycyIsImVuYWJsZVZhbGlkYXRpb24iLCJidXR0b24iLCJjbG9zZXN0IiwibmFtZUlucHV0IiwicHJvZmlsZU5hbWUiLCJqb2JJbnB1dCIsInByb2ZpbGVKb2IiLCJzYXZlQnV0dG9uIiwicmVtb3ZlQXR0cmlidXRlIiwiYWxsIiwiY2FyZHMiLCJfcmVmMiIsInVzZXJJbmZvIiwiaW5pdGlhbENhcmRzIiwid2luZG93IiwiYWJvdXQiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJhdmF0YXIiLCJpbm5lckhUTUwiLCJhcHBlbmRDaGlsZCIsImVycm9ycyIsImJvZHkiLCJmaW5hbGx5IiwicmVzZXQiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwidmFsdWVzIiwiT2JqZWN0IiwiZnJvbUVudHJpZXMiLCJ2YWx1ZU5hbWUiLCJ2YWx1ZVVybCIsInByZXBlbmQiLCJwb3AiLCJhdmF0YXJMaW5rIiwidXBkYXRlQXZhdGFyIl0sInNvdXJjZVJvb3QiOiIifQ==