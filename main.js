(()=>{"use strict";var e={baseUrl:"https://nomoreparties.co/v1/wff-cohort-2",headers:{authorization:"29e47ff3-c405-4d45-9bbb-503bd9191003","Content-Type":"application/json"}},t=function(){return fetch("".concat(e.baseUrl,"/cards"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))};function n(e,t,n,r,o){var c=document.getElementById("card-template").content.firstElementChild.cloneNode(!0),a=c.querySelector(".card__title"),i=c.querySelector(".card__image");a.textContent=e.name,i.src=e.link,i.alt=e.name;var u=c.querySelector(".card__like-count");u.textContent=e.likes.length;var s=c.querySelector(".card__like-button");s.addEventListener("click",(function(){n(s,u,e._id),u.textContent=e.likes.length}));var l=e._id;return o===e.owner._id?c.querySelector(".card__delete-button").addEventListener("click",(function(){t(c,l)})):c.querySelector(".card__delete-button").style.display="none",i.addEventListener("click",(function(){r(c,i)})),c}function r(t,n,r){t.classList.contains("card__like-button_is-active")?function(t){var n="".concat(e.baseUrl,"/cards/likes/").concat(t);return fetch(n,{method:"DELETE",headers:e.headers}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.error("Ошибка снятия лайка:",e)}))}(r).then((function(e){t.classList.remove("card__like-button_is-active"),n.textContent=e.likes.length})):function(t){var n="".concat(e.baseUrl,"/cards/likes/").concat(t);return fetch(n,{method:"PUT",headers:e.headers}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.error("Ошибка постановки лайка:",e)}))}(r).then((function(e){t.classList.add("card__like-button_is-active"),n.textContent=e.likes.length}))}function o(e,t){(function(e){return fetch("https://nomoreparties.co/v1/wff-cohort-2/cards/".concat(e),{method:"DELETE",headers:{authorization:"29e47ff3-c405-4d45-9bbb-503bd9191003"}}).then((function(e){if(e.ok)return e.json();throw new Error("Ошибка: ".concat(e.status))}))})(t).then((function(){e.remove()})).catch((function(e){console.error("Ошибка удаления карточки:",e)}))}function c(e){e.classList.add("popup_is-animated"),e.classList.add("popup_is-opened"),document.addEventListener("keydown",i),document.addEventListener("click",u)}function a(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",i),document.removeEventListener("click",u)}var i=function(e){"Escape"===e.code&&a(document.querySelector(".popup_is-opened"))},u=function(e){var t=e.target;t.classList.contains("popup_is-opened")&&a(t)};function s(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);n.forEach((function(n){l(e,n,t)})),r&&(r.classList.add(t.inactiveButtonClass),r.disabled=!0)}function l(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));r.textContent="",r.classList.remove(n.errorClass),t.classList.remove(n.inputErrorClass)}function d(e,t,n){e.every((function(e){return e.validity.valid}))?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):(t.classList.add(n.inactiveButtonClass),t.disabled=!0)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=document.querySelector(".popup_type_edit"),_=document.querySelector(".popup_type_new-card"),m=document.querySelector(".popup_type_image"),v=document.querySelector(".popup_type_avatar"),y=f.querySelector(".popup__form"),h=_.querySelector(".popup__form"),b=v.querySelector(".popup__form"),S=document.querySelector(".profile__edit-button"),C=document.querySelectorAll(".popup__close"),q=document.querySelector(".profile__add-button"),E=document.querySelector(".popup__image"),k=document.querySelector(".popup__caption"),L=document.querySelector(".profile__image");L.addEventListener("click",(function(){c(v)}));var g=document.querySelector(".places__list"),x={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function j(e,t){c(m);var n=e.querySelector(".card__title");E.src=t.src,k.textContent=n.textContent,m.src=t.src,m.alt=n.textContent}function A(e,t,r,o){e.forEach((function(e){var c=n(e,t,r,o,userInfo._id);g.appendChild(c)}))}!function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);s(e,t),n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){if(t.validity.patternMismatch){var r=t.dataset.errorMessage||t.validationMessage;""===t.value.trim()?t.setCustomValidity(""):t.setCustomValidity(r)}else t.setCustomValidity("");t.validity.valid?l(e,t,n):function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));o.textContent=n,o.classList.add(r.errorClass),t.classList.add(r.inputErrorClass)}(e,t,t.validationMessage,n)}(e,o,t),d(n,r,t)}))})),e.addEventListener("reset",(function(){s(e,t)})),d(n,r,t)}(t,e)}))}(x),C.forEach((function(e){e.addEventListener("click",(function(){a(e.closest(".popup"))}))})),S.addEventListener("click",(function(){c(f),w.value=P.textContent,T.value=U.textContent,y.querySelector(".popup__button"),s(y,x)}));var w=y.querySelector(".popup__input_type_name"),T=y.querySelector(".popup__input_type_description"),P=document.querySelector(".profile__title"),U=document.querySelector(".profile__description");w.value=P.textContent,T.value=U.textContent,Promise.all([fetch("".concat(e.baseUrl,"/users/me"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})),t()]).then((function(e){var n,c,a=(c=2,function(e){if(Array.isArray(e))return e}(n=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,a,i=[],u=!0,s=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return i}}(n,c)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(n,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=a[0],u=a[1];return window.userInfo=i,P.textContent=i.name,U.textContent=i.about,L.style.backgroundImage="url(".concat(i.avatar,")"),g.innerHTML="",A(u,o,r,j),t()})).catch((function(e){console.error("Произошла ошибка:",e)})),y.addEventListener("submit",(function(t){t.preventDefault();var n=y.querySelector(".popup__button");n.textContent="Сохранение...",setTimeout((function(){var t,r;(t=w.value,r=T.value,fetch("".concat(e.baseUrl,"/users/me"),{method:"PATCH",headers:e.headers,body:JSON.stringify({name:t,about:r})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){P.textContent=e.name,U.textContent=e.about})).finally((function(){n.textContent="Сохранить"})),a(f),s(y,x)}),1e3)})),q.addEventListener("click",(function(){c(_),h.reset(),s(h,x)})),h.addEventListener("submit",(function(t){t.preventDefault();var c=t.target,i=new FormData(c),u=Object.fromEntries(i),s=u["place-name"],l=u.link,d=h.querySelector(".popup__button");d.textContent="Сохранение...",setTimeout((function(){var t,i;(t=s,i=l,fetch("".concat(e.baseUrl,"/cards"),{method:"POST",headers:e.headers,body:JSON.stringify({name:t,link:i})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){var t=n(e,o,r,j,userInfo._id);g.prepend(t),c.reset(),a(_)})).catch((function(e){console.error("Ошибка добавления карточки:",e)})).finally((function(){d.textContent="Сохранить"})),a(_)}),1e3)})),document.querySelectorAll(".popup").forEach((function(e){return e.classList.add("popup_is-animated")})),b.addEventListener("submit",(function(t){t.preventDefault();var n=t.target.querySelector(".popup__input_type_avatar-url").value,r=b.querySelector(".popup__button");r.textContent="Сохранение...",setTimeout((function(){(function(t){return fetch("".concat(e.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:e.headers,body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))})(n).then((function(){L.style.backgroundImage="url(".concat(n,")"),a(v)})).catch((function(e){console.error("Ошибка обновления аватара:",e)})).finally((function(){r.textContent="Сохранить"}))}))}),1e3)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0ksU0FBUSxTQUFDOEUsR0FBRyxPQUFLQSxFQUFJbEgsVUFBVVcsSUFBSSxvQkFBb0IsSUFHL0Q0QyxFQUFlL0QsaUJBQWlCLFVBQVUsU0FBVStCLEdBQ2xEQSxFQUFNaUQsaUJBRU4sSUFDTTJDLEVBRGtCNUYsRUFBTUcsT0FBTzdDLGNBQWMsaUNBQ2hCZ0csTUFDN0JzQixFQUFhNUMsRUFBZTFFLGNBQWMsa0JBQ2hEc0gsRUFBV3BILFlBQWMsZ0JBQ3pCcUgsWUFBVyxZSnBHZSxTQUFDZSxHQUMzQixPQUFPNUosTUFBTSxHQUFEQyxPQUFJTixFQUFPQyxRQUFPLG9CQUFvQixDQUNoRGdELE9BQVEsUUFFUi9DLFFBQVNGLEVBQU9FLFFBRWhCaUosS0FBTUMsS0FBS0MsVUFBVSxDQUFFUCxPQUFRbUIsTUFFOUIxSixNQUFLLFNBQUFDLEdBQ0osT0FBSUEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTkMsUUFBUUMsT0FBTyxXQUFETixPQUFZRSxFQUFJSyxRQUN2QyxHQUNKLEVJdUZJcUosQ0FBYUQsR0FDVjFKLE1BQUssV0FDSm9HLEVBQVdqRSxNQUFNbUcsZ0JBQWtCLE9BQUh2SSxPQUFVMkosRUFBVSxLQUNwRDlGLEVBQVcrQixFQUNiLElBQ0NoRCxPQUFNLFNBQUFDLEdBQ0xDLFFBQVFELE1BQU0sNkJBQThCQSxFQUM5QyxJQUNDbUcsU0FBUSxXQUNQTCxFQUFXcEgsWUFBYyxXQUMzQixHQUNKLEdBQ0YsR0FBRyxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9hcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9jYXJkLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvbW9kYWwuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGJhc2VVcmw6ICdodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2ZmLWNvaG9ydC0yJyxcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246ICcyOWU0N2ZmMy1jNDA1LTRkNDUtOWJiYi01MDNiZDkxOTEwMDMnLFxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgZ2V0SW5pdGlhbENhcmRzID0gKCkgPT4ge1xuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXG4gIH0pXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xufVxuXG5leHBvcnQgY29uc3QgdXBkYXRlVXNlckluZm8gPSAobmFtZSwgYWJvdXQpID0+IHtcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dCB9KVxuICB9KVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IGNvbnN0IGdldFVzZXJJbmZvID0gKCkgPT4ge1xuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXG4gIH0pXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xufVxuXG5leHBvcnQgY29uc3QgcG9zdENhcmQgPSAobmFtZSwgbGluaykgPT4ge1xuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIG5hbWUsXG4gICAgICBsaW5rXG4gICAgfSlcbiAgfSlcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG59XG5cbmV4cG9ydCBjb25zdCBkZWxldGVDYXJkRnJvbVNlcnZlciA9IChjYXJkSWQpID0+IHtcbiAgcmV0dXJuIGZldGNoKGBodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2ZmLWNvaG9ydC0yL2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIGF1dGhvcml6YXRpb246ICcyOWU0N2ZmMy1jNDA1LTRkNDUtOWJiYi01MDNiZDkxOTEwMDMnXG4gICAgfVxuICB9KVxuICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGDQntGI0LjQsdC60LA6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgIH0pO1xufTtcblxuXG5leHBvcnQgZnVuY3Rpb24gcG9zdExpa2UoY2FyZElkKSB7XG4gIGNvbnN0IGFwaVVybCA9IGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gO1xuICByZXR1cm4gZmV0Y2goYXBpVXJsLCB7XG4gICAgbWV0aG9kOiAnUFVUJyxcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVyc1xuICB9KVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgIH0pXG4gICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ9Ce0YjQuNCx0LrQsCDQv9C+0YHRgtCw0L3QvtCy0LrQuCDQu9Cw0LnQutCwOicsIGVycm9yKTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZUxpa2UoY2FyZElkKSB7XG4gIGNvbnN0IGFwaVVybCA9IGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gO1xuICByZXR1cm4gZmV0Y2goYXBpVXJsLCB7XG4gICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVyc1xuICB9KVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgIH0pXG4gICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ9Ce0YjQuNCx0LrQsCDRgdC90Y/RgtC40Y8g0LvQsNC50LrQsDonLCBlcnJvcik7XG4gICAgfSk7XG59XG5cbmV4cG9ydCBjb25zdCB1cGRhdGVBdmF0YXIgPSAoYXZhdGFyTGluaykgPT4ge1xuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICBtZXRob2Q6ICdQQVRDSCcsXG5cbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcblxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiBhdmF0YXJMaW5rIH0pXG4gIH0pXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xufSIsIlxuaW1wb3J0IHsgb3Blbk1vZGFsIH0gZnJvbSBcIi4vbW9kYWxcIjtcbmltcG9ydCB7IHBvcHVwSW1nIH0gZnJvbSBcIi4uXCI7XG5pbXBvcnQgeyBkZWxldGVDYXJkRnJvbVNlcnZlciwgcG9zdExpa2UsIGRlbGV0ZUxpa2UgfSBmcm9tIFwiLi9hcGlcIlxuXG4vLz8gQHRvZG86INCk0YPQvdC60YbQuNGPINGB0L7Qt9C00LDQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuFxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNhcmQoZGF0YSwgZGVsZXRlQ2FsbGJhY2ssIHRvb2dsZUhlYXJ0Q2FsbGJhY2ssIG9wZW5CaWdJbWFnZUNhbGxiYWNrLCBvd25lcklkKSB7XG4gIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYXJkLXRlbXBsYXRlJyk7XG4gIGNvbnN0IG5ld0NhcmQgPSBjYXJkVGVtcGxhdGUuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZC5jbG9uZU5vZGUodHJ1ZSk7IC8vINCa0LvQvtC90LjRgNGD0Y4g0YjQsNCx0LvQvtC9INC60LDRgNGC0L7Rh9C60LhcbiAgLy8g0KPRgdGC0LDQvdCw0LLQu9C40LLQsNGOINC30L3QsNGH0LXQvdC40Y8g0LLQu9C+0LbQtdC90L3Ri9GFINGN0LvQtdC80LXQvdGC0L7QslxuICBjb25zdCB0aXRsZUNhcmRlbCA9IG5ld0NhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJylcbiAgY29uc3QgcGhvdG9DYXJkRWwgPSBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG5cbiAgdGl0bGVDYXJkZWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gIHBob3RvQ2FyZEVsLnNyYyA9IGRhdGEubGluaztcbiAgcGhvdG9DYXJkRWwuYWx0ID0gZGF0YS5uYW1lO1xuXG4gIGNvbnN0IGxpa2VDb3VudEVsZW1lbnQgPSBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50Jyk7XG4gIGxpa2VDb3VudEVsZW1lbnQudGV4dENvbnRlbnQgPSBkYXRhLmxpa2VzLmxlbmd0aDtcbiAgLy/QoNCw0LHQvtGC0LDRjiDRgSDQuNC60L7QvdC60L7QuSDRgdC10YDQtNGG0LBcbiAgY29uc3QgbGlrZUhlYXJ0ID0gbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICBsaWtlSGVhcnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgdG9vZ2xlSGVhcnRDYWxsYmFjayhsaWtlSGVhcnQsIGxpa2VDb3VudEVsZW1lbnQsIGRhdGEuX2lkKTtcbiAgICBsaWtlQ291bnRFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5saWtlcy5sZW5ndGg7XG4gIH0pO1xuICBjb25zdCBjYXJkSWQgPSBkYXRhLl9pZDtcblxuXG4gIC8vINCU0L7QsdCw0LLQu9GP0LXQvCDQvtCx0YDQsNCx0L7RgtGH0LjQuiDQutC70LjQutCwINC90LAg0LjQutC+0L3QutGDINGD0LTQsNC70LXQvdC40Y8g0YLQvtC70YzQutC+INC00LvRjyDQutCw0YDRgtC+0YfQtdC6LCDRgdC+0LfQtNCw0L3QvdGL0YUg0YLQtdC60YPRidC40Lwg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9C10LxcbiAgaWYgKG93bmVySWQgPT09IGRhdGEub3duZXIuX2lkKSB7XG4gICAgY29uc3QgZGVsZXRlSWNvbiA9IG5ld0NhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKTtcbiAgICBkZWxldGVJY29uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgZGVsZXRlQ2FsbGJhY2sobmV3Q2FyZCwgY2FyZElkKTsgLy8g0J/QtdGA0LXQtNCw0LXQvCBET00t0Y3Qu9C10LzQtdC90YIg0LrQsNGA0YLQvtGH0LrQuCDQsiDQutC+0LvQsdGN0LpcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICAvLyDQldGB0LvQuCDQutCw0YDRgtC+0YfQutCwINC90LUg0YHQvtC30LTQsNC90LAg0YLQtdC60YPRidC40Lwg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9C10LwsINGB0LrRgNGL0LLQsNC10Lwg0LjQutC+0L3QutGDINGD0LTQsNC70LXQvdC40Y9cbiAgICBjb25zdCBkZWxldGVJY29uID0gbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ1dHRvbicpO1xuICAgIGRlbGV0ZUljb24uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgfVxuXG4gIC8vINCU0L7QsdCw0LLQu9GP0LXQvCDQvtCx0YDQsNCx0L7RgtGH0LjQuiDQutC70LjQutCwINC90LAg0LjQutC+0L3QutGDINGD0LTQsNC70LXQvdC40Y9cbiAgLy9jb25zdCBkZWxldGVJY29uID0gbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ1dHRvbicpO1xuICAvL2RlbGV0ZUljb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIC8vICBkZWxldGVDYWxsYmFjayhuZXdDYXJkKTsgLy8g0J/QtdGA0LXQtNCw0LXQvCBET00t0Y3Qu9C10LzQtdC90YIg0LrQsNGA0YLQvtGH0LrQuCDQsiDQutC+0LvQsdGN0LogINC4ICAvLyDQktGL0LfRi9Cy0LDQtdC8INC/0LXRgNC10LTQsNC90L3Ri9C5INC60L7Qu9Cx0Y3QuiDRgSDQuNC00LXQvdGC0LjRhNC40LrQsNGC0L7RgNC+0Lwg0LrQsNGA0YLQvtGH0LrQuFxuICAvL30pXG5cbiAgLy8gINCe0KLQmtCg0KvQotCY0JUg0J/QntCf0JDQn9CQINChINCa0JDQoNCi0JjQndCa0J7QmSBcbiAgcGhvdG9DYXJkRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgb3BlbkJpZ0ltYWdlQ2FsbGJhY2sobmV3Q2FyZCwgcGhvdG9DYXJkRWwpXG4gIH0pXG4gIHJldHVybiBuZXdDYXJkO1xufVxuXG4vL0B0b2RvOiDQpNGD0L3QutGG0LjRjyDQvtCx0YDQsNCx0L7RgtC60LAg0LvQsNC50LrQsFxuZXhwb3J0IGZ1bmN0aW9uIHRvb2dsZUhlYXJ0KGhlYXJ0LCBsaWtlQ291bnRFbGVtZW50LCBjYXJkSWQpIHtcbiAgY29uc3QgaXNMaWtlZCA9IGhlYXJ0LmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZVwiKTtcblxuXG5cbiAgaWYgKCFpc0xpa2VkKSB7XG4gICAgcG9zdExpa2UoY2FyZElkKVxuICAgICAgLnRoZW4odXBkYXRlZENhcmQgPT4ge1xuICAgICAgICBoZWFydC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlXCIpO1xuICAgICAgICBsaWtlQ291bnRFbGVtZW50LnRleHRDb250ZW50ID0gdXBkYXRlZENhcmQubGlrZXMubGVuZ3RoO1xuICAgICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgZGVsZXRlTGlrZShjYXJkSWQpXG4gICAgICAudGhlbih1cGRhdGVkQ2FyZCA9PiB7XG4gICAgICAgIGhlYXJ0LmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmVcIik7XG4gICAgICAgIGxpa2VDb3VudEVsZW1lbnQudGV4dENvbnRlbnQgPSB1cGRhdGVkQ2FyZC5saWtlcy5sZW5ndGg7XG4gICAgICB9KTtcbiAgfVxufVxuLy9AdG9kbzog0KTRg9C90LrRhtC40Y8g0YPQtNCw0LvQtdC90LjRjyDQutCw0YDRgtC+0YfQutC4XG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgY2FyZElkKSB7XG4gIGRlbGV0ZUNhcmRGcm9tU2VydmVyKGNhcmRJZClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKCfQntGI0LjQsdC60LAg0YPQtNCw0LvQtdC90LjRjyDQutCw0YDRgtC+0YfQutC4OicsIGVycm9yKTtcbiAgICB9KTtcbn1cblxuXG4iLCIvL9Ck0YPQvdC60YbQuNGPINC+0YLQutGA0YvRgtC40Y8g0L/QvtC/0LDQv9CwXG5leHBvcnQgZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX2lzLWFuaW1hdGVkJyk7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX2lzLW9wZW5lZCcpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywga2V5RG93bkhhbmRsZXIpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGRvY3VtZW50Q2xpY2tIYW5kbGVyKTtcbn1cbi8v0KTRg9C90LrRhtC40Y8g0LfQsNC60YDRi9GC0LjRjyDQv9C+0L/QsNC/0LBcbmV4cG9ydCBmdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX2lzLW9wZW5lZCcpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywga2V5RG93bkhhbmRsZXIpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGRvY3VtZW50Q2xpY2tIYW5kbGVyKTtcbn1cblxuY29uc3Qga2V5RG93bkhhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgaWYgKGV2ZW50LmNvZGUgPT09IFwiRXNjYXBlXCIpIHtcbiAgICBjb25zdCBvcGVuZWRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9pcy1vcGVuZWQnKTtcbiAgICBjbG9zZU1vZGFsKG9wZW5lZFBvcHVwKTtcbiAgfVxufVxuXG5jb25zdCBkb2N1bWVudENsaWNrSGFuZGxlciA9ICh7IHRhcmdldCB9KSA9PiB7XG4gIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9pcy1vcGVuZWQnKSkge1xuICAgIGNsb3NlTW9kYWwodGFyZ2V0KTtcbiAgfVxufSAiLCJcbmV4cG9ydCBmdW5jdGlvbiBlbmFibGVWYWxpZGF0aW9uKGNvbmZpZykge1xuICBjb25zdCBmb3JtcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XG5cbiAgZm9ybXMuZm9yRWFjaCgoZm9ybSkgPT4ge1xuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtLCBjb25maWcpO1xuICB9KTtcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJWYWxpZGF0aW9uKGZvcm0sIGNvbmZpZykge1xuICBjb25zdCBpbnB1dHMgPSBBcnJheS5mcm9tKGZvcm0ucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xuICBjb25zdCBzdWJtaXRCdXR0b24gPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybSwgaW5wdXQsIGNvbmZpZyk7XG4gIH0pO1xuICBpZiAoc3VibWl0QnV0dG9uKSB7XG4gICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybSwgY29uZmlnKSB7XG4gIGNvbnN0IGlucHV0cyA9IEFycmF5LmZyb20oZm9ybS5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGZvcm0ucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICBjbGVhclZhbGlkYXRpb24oZm9ybSwgY29uZmlnKVxuICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtLCBpbnB1dCwgY29uZmlnKTtcbiAgICAgIHRvZ2dsZVN1Ym1pdEJ1dHRvblN0YXRlKGlucHV0cywgc3VibWl0QnV0dG9uLCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcblxuICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2V0JywgZnVuY3Rpb24gKCkge1xuICAgIGNsZWFyVmFsaWRhdGlvbihmb3JtLCBjb25maWcpO1xuICB9KTtcblxuICB0b2dnbGVTdWJtaXRCdXR0b25TdGF0ZShpbnB1dHMsIHN1Ym1pdEJ1dHRvbiwgY29uZmlnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtLCBpbnB1dCwgY29uZmlnKSB7XG4gIGlmIChpbnB1dC52YWxpZGl0eS5wYXR0ZXJuTWlzbWF0Y2gpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBpbnB1dC5kYXRhc2V0LmVycm9yTWVzc2FnZSB8fCBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcblxuICAgIGlmIChpbnB1dC52YWx1ZS50cmltKCkgPT09ICcnKSB7XG4gICAgICBpbnB1dC5zZXRDdXN0b21WYWxpZGl0eSgnJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlucHV0LnNldEN1c3RvbVZhbGlkaXR5KGVycm9yTWVzc2FnZSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlucHV0LnNldEN1c3RvbVZhbGlkaXR5KCcnKTtcbiAgfVxuXG4gIGlmICghaW5wdXQudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtLCBpbnB1dCwgaW5wdXQudmFsaWRhdGlvbk1lc3NhZ2UsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybSwgaW5wdXQsIGNvbmZpZyk7XG4gIH1cbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gc2hvd0lucHV0RXJyb3IoZm9ybSwgaW5wdXQsIGVycm9yTWVzc2FnZSwgY29uZmlnKSB7XG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXQuaWR9LWVycm9yYCk7XG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmVycm9yQ2xhc3MpO1xuICBpbnB1dC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGlkZUlucHV0RXJyb3IoZm9ybSwgaW5wdXQsIGNvbmZpZykge1xuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0LmlkfS1lcnJvcmApO1xuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmVycm9yQ2xhc3MpO1xuICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xufVxuXG5mdW5jdGlvbiB0b2dnbGVTdWJtaXRCdXR0b25TdGF0ZShpbnB1dHMsIHN1Ym1pdEJ1dHRvbiwgY29uZmlnKSB7XG4gIGNvbnN0IGlzVmFsaWQgPSBpbnB1dHMuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XG5cbiAgaWYgKGlzVmFsaWQpIHtcbiAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH0gZWxzZSB7XG4gICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cbn1cbiIsImltcG9ydCAnLi9wYWdlcy9pbmRleC5jc3MnO1xuLy9pbXBvcnQgeyBpbml0aWFsQ2FyZHMgfSBmcm9tICcuL2NhcmRzJztcbmltcG9ydCB7IGNyZWF0ZUNhcmQsIHRvb2dsZUhlYXJ0LCBkZWxldGVDYXJkIH0gZnJvbSAnLi9jb21wb25lbnRzL2NhcmQnO1xuaW1wb3J0IHsgb3Blbk1vZGFsLCBjbG9zZU1vZGFsIH0gZnJvbSAnLi9jb21wb25lbnRzL21vZGFsJztcbmltcG9ydCB7IGVuYWJsZVZhbGlkYXRpb24sIGNsZWFyVmFsaWRhdGlvbiwgc2V0RXZlbnRMaXN0ZW5lcnMgfSBmcm9tICcuL2NvbXBvbmVudHMvdmFsaWRhdGlvbic7XG5cbmltcG9ydCB7IGdldEluaXRpYWxDYXJkcywgdXBkYXRlVXNlckluZm8sIGdldFVzZXJJbmZvLCBwb3N0Q2FyZCwgZGVsZXRlQ2FyZEZyb21TZXJ2ZXIsIHVwZGF0ZUF2YXRhciB9IGZyb20gJy4vY29tcG9uZW50cy9hcGknO1xuXG4vL0FsbCBtb2RhbCB3aW5kb3cvL1xuY29uc3QgcG9wdXBFZGl0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2VkaXQnKVxuY29uc3QgcG9wdXBBZGRDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfbmV3LWNhcmQnKTtcbmV4cG9ydCBjb25zdCBwb3B1cEltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2ltYWdlJyk7XG5jb25zdCBwb3B1cEVkaXRBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hdmF0YXInKVxuXG4vL0FsbCBmb3JtLy9cbmNvbnN0IGZvcm1FZGl0UHJvZmlsZSA9IHBvcHVwRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJylcbmNvbnN0IGZvcm1BZGRDYXJkID0gcG9wdXBBZGRDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpXG5jb25zdCBmb3JtRWRpdEF2YXRhciA9IHBvcHVwRWRpdEF2YXRhci5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKVxuXG4vL0J1dHRvbnMgb3BlbiAmIGNsb3NlLy9cbmNvbnN0IG9wZW5FZGl0QnRuUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuY29uc3QgY2xvc2VCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19jbG9zZScpO1xuY29uc3Qgb3BlbkJ0bkFkZENhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xuXG5jb25zdCBwb3B1cEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xuY29uc3QgcG9wdXBDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXB0aW9uJyk7XG5cbmNvbnN0IHVzZXJBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1hZ2UnKTtcblxudXNlckF2YXRhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsgb3Blbk1vZGFsKHBvcHVwRWRpdEF2YXRhcikgfSk7XG5cblxuXG5cbi8vIEB0b2RvOiBET00g0YPQt9C70YtcbmNvbnN0IGxpc3RDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VzX19saXN0Jyk7XG5cbi8vZ2V0SW5pdGlhbENhcmRzKClcbi8vICAudGhlbihjYXJkcyA9PiB7XG4vLyAgICBsaXN0Q29udGFpbmVyLmlubmVySFRNTCA9ICcnOyAvLyDQntGH0LjRidCw0LXQvCDQutC+0L3RgtC10LnQvdC10YAg0L/QtdGA0LXQtCDQt9Cw0LPRgNGD0LfQutC+0Lkg0L3QvtCy0YvRhSDQutCw0YDRgtC+0YfQtdC6XG4vLyAgICByZW5kZXJDYXJkcyhjYXJkcywgZGVsZXRlQ2FyZCwgdG9vZ2xlSGVhcnQsIG9wZW5CaWdJbWFnZSk7XG4vLyAgfSlcbi8vICAuY2F0Y2goZXJyb3IgPT4ge1xuLy8gICAgY29uc29sZS5lcnJvcign0J7RiNC40LHQutCwINC30LDQs9GA0YPQt9C60Lgg0LrQsNGA0YLQvtGH0LXQuiDRgSDRgdC10YDQstC10YDQsCcsIGVycm9yKTtcbi8vICB9KTtcblxuY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiAnLnBvcHVwX19mb3JtJyxcbiAgaW5wdXRTZWxlY3RvcjogJy5wb3B1cF9faW5wdXQnLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fYnV0dG9uJyxcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19idXR0b25fZGlzYWJsZWQnLFxuICBpbnB1dEVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXRfdHlwZV9lcnJvcicsXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9fZXJyb3JfdmlzaWJsZSdcbn1cblxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcblxuY2xvc2VCdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4ge1xuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgY2xvc2VNb2RhbChidXR0b24uY2xvc2VzdCgnLnBvcHVwJykpO1xuICB9KTtcbn0pO1xuXG4vLyBAdG9kbzog0KTRg9C90LrRhtC40Y8g0L7QutGC0YDRi9GC0LjRjyDQv9C+0L/QsNC/0LAg0LrQsNGA0YLQuNC90LrQuFxuZnVuY3Rpb24gb3BlbkJpZ0ltYWdlKG5ld0NhcmQsIHBob3RvQ2FyZEVsKSB7XG4gIG9wZW5Nb2RhbChwb3B1cEltZyk7XG4gIGNvbnN0IGNhcmRUaXRsZSA9IG5ld0NhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJyk7XG5cbiAgcG9wdXBJbWFnZS5zcmMgPSBwaG90b0NhcmRFbC5zcmM7XG4gIHBvcHVwQ2FwdGlvbi50ZXh0Q29udGVudCA9IGNhcmRUaXRsZS50ZXh0Q29udGVudDtcbiAgcG9wdXBJbWcuc3JjID0gcGhvdG9DYXJkRWwuc3JjO1xuICBwb3B1cEltZy5hbHQgPSBjYXJkVGl0bGUudGV4dENvbnRlbnQ7XG59XG5cbi8vPyBAdG9kbzog0JLRi9Cy0LXRgdGC0Lgg0LrQsNGA0YLQvtGH0LrQuCDQvdCwINGB0YLRgNCw0L3QuNGG0YNcblxuZnVuY3Rpb24gcmVuZGVyQ2FyZHMoY2FyZHMsIGRlbGV0ZUNhbGxiYWNrLCB0b29nbGVIZWFydENhbGxiYWNrLCBvcGVuQmlnSW1hZ2VDYWxsYmFjaykge1xuICAvLyDQodC+0LfQtNCw0LXQvCDQuCDQtNC+0LHQsNCy0LvRj9C10Lwg0LrQsNGA0YLQvtGH0LrQuCDQsiDQutC+0L3RgtC10LnQvdC10YBcbiAgY2FyZHMuZm9yRWFjaChkYXRhID0+IHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSwgZGVsZXRlQ2FsbGJhY2ssIHRvb2dsZUhlYXJ0Q2FsbGJhY2ssIG9wZW5CaWdJbWFnZUNhbGxiYWNrLCB1c2VySW5mby5faWQpO1xuICAgIGxpc3RDb250YWluZXIuYXBwZW5kQ2hpbGQoY2FyZEVsZW1lbnQpO1xuICB9KTtcbn1cbi8vPyDQntGC0LrRgNGL0YLQuNC1INC4INC30LDQutGA0YvRgtC40LUg0L/QvtC/0LDQv9CwIHBvcHVwRWRpdFByb2ZpbGVcbm9wZW5FZGl0QnRuUG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChwb3B1cEVkaXRQcm9maWxlKTtcblxuICBuYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbiAgam9iSW5wdXQudmFsdWUgPSBwcm9maWxlSm9iLnRleHRDb250ZW50O1xuICBjb25zdCBidG4gPSBmb3JtRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcblxuICAvL3NldEV2ZW50TGlzdGVuZXJzKGZvcm1FZGl0UHJvZmlsZSwgdmFsaWRhdGlvbkNvbmZpZyk7XG4gIGNsZWFyVmFsaWRhdGlvbihmb3JtRWRpdFByb2ZpbGUsIHZhbGlkYXRpb25Db25maWcpIC8vINGB0LTQtdC70LDRgtGMINGC0LDQuiwg0YfRgtC+0LHRi9C/XG59KTtcblxuLy8/INCd0LDRhdC+0LTQuNC8INC/0L7Qu9GPINGE0L7RgNC80Ysg0LIgRE9NXG5jb25zdCBuYW1lSW5wdXQgPSBmb3JtRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX25hbWUnKTtcbmNvbnN0IGpvYklucHV0ID0gZm9ybUVkaXRQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9kZXNjcmlwdGlvbicpO1xuXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5jb25zdCBwcm9maWxlSm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKVxuXG5uYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbmpvYklucHV0LnZhbHVlID0gcHJvZmlsZUpvYi50ZXh0Q29udGVudDtcblxuXG5cblByb21pc2UuYWxsKFtnZXRVc2VySW5mbygpLCBnZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC50aGVuKChbdXNlckluZm8sIGluaXRpYWxDYXJkc10pID0+IHtcbiAgICB3aW5kb3cudXNlckluZm8gPSB1c2VySW5mbztcbiAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXJJbmZvLm5hbWU7XG4gICAgcHJvZmlsZUpvYi50ZXh0Q29udGVudCA9IHVzZXJJbmZvLmFib3V0O1xuXG4gICAgdXNlckF2YXRhci5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7dXNlckluZm8uYXZhdGFyfSlgO1xuXG4gICAgLy8g0J7Rh9C40YnQsNC10Lwg0LrQvtC90YLQtdC50L3QtdGAINC/0LXRgNC10LQg0LfQsNCz0YDRg9C30LrQvtC5INC90L7QstGL0YUg0LrQsNGA0YLQvtGH0LXQulxuICAgIGxpc3RDb250YWluZXIuaW5uZXJIVE1MID0gJyc7XG5cbiAgICAvLyDQoNC10L3QtNC10YDQuNC8INC60LDRgNGC0L7Rh9C60LhcbiAgICByZW5kZXJDYXJkcyhpbml0aWFsQ2FyZHMsIGRlbGV0ZUNhcmQsIHRvb2dsZUhlYXJ0LCBvcGVuQmlnSW1hZ2UpO1xuICAgIHJldHVybiBnZXRJbml0aWFsQ2FyZHMoKVxuICB9KVxuICAuY2F0Y2goZXJyb3JzID0+IHtcbiAgICBjb25zb2xlLmVycm9yKCfQn9GA0L7QuNC30L7RiNC70LAg0L7RiNC40LHQutCwOicsIGVycm9ycyk7XG4gIH0pO1xuXG4vL2dldFVzZXJJbmZvKClcbi8vICAudGhlbigodXNlckluZm8pID0+IHtcbi8vICAgIHdpbmRvdy51c2VySW5mbyA9IHVzZXJJbmZvO1xuLy8gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VySW5mby5uYW1lO1xuLy8gICAgcHJvZmlsZUpvYi50ZXh0Q29udGVudCA9IHVzZXJJbmZvLmFib3V0O1xuLy8gICAgdXNlckF2YXRhci51cmwgPSB1c2VySW5mby5hdmF0YXI7XG4vLyAgICByZXR1cm4gZ2V0SW5pdGlhbENhcmRzKClcbi8vICB9KVxuXG5mb3JtRWRpdFByb2ZpbGUuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGZvcm1FZGl0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbicpO1xuICBzYXZlQnV0dG9uLnRleHRDb250ZW50ID0gJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJztcblxuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICB1cGRhdGVVc2VySW5mbyhuYW1lSW5wdXQudmFsdWUsIGpvYklucHV0LnZhbHVlKVxuICAgICAgLnRoZW4oKHVzZXJJbmZvKSA9PiB7XG4gICAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckluZm8ubmFtZTtcbiAgICAgICAgcHJvZmlsZUpvYi50ZXh0Q29udGVudCA9IHVzZXJJbmZvLmFib3V0O1xuXG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuXG4gICAgICAgIHNhdmVCdXR0b24udGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LjRgtGMJztcbiAgICAgIH0pO1xuXG4gICAgY2xvc2VNb2RhbChwb3B1cEVkaXRQcm9maWxlKTtcblxuICAgIGNsZWFyVmFsaWRhdGlvbihmb3JtRWRpdFByb2ZpbGUsIHZhbGlkYXRpb25Db25maWcpO1xuICB9LCAxMDAwKTtcbn0pO1xuXG5cbm9wZW5CdG5BZGRDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBvcGVuTW9kYWwocG9wdXBBZGRDYXJkKTtcbiAgZm9ybUFkZENhcmQucmVzZXQoKTtcblxuICBjbGVhclZhbGlkYXRpb24oZm9ybUFkZENhcmQsIHZhbGlkYXRpb25Db25maWcpO1xufSlcblxuZm9ybUFkZENhcmQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGZvcm0gPSBldmVudC50YXJnZXQ7XG4gIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGZvcm0pO1xuICBjb25zdCB2YWx1ZXMgPSBPYmplY3QuZnJvbUVudHJpZXMoZm9ybURhdGEpO1xuICBjb25zdCB2YWx1ZU5hbWUgPSB2YWx1ZXNbJ3BsYWNlLW5hbWUnXTtcbiAgY29uc3QgdmFsdWVVcmwgPSB2YWx1ZXNbJ2xpbmsnXTtcblxuICBjb25zdCBzYXZlQnV0dG9uID0gZm9ybUFkZENhcmQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcbiAgc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLic7XG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIHBvc3RDYXJkKHZhbHVlTmFtZSwgdmFsdWVVcmwpXG4gICAgICAudGhlbihuZXdDYXJkID0+IHtcblxuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQobmV3Q2FyZCwgZGVsZXRlQ2FyZCwgdG9vZ2xlSGVhcnQsIG9wZW5CaWdJbWFnZSwgdXNlckluZm8uX2lkKTtcbiAgICAgICAgbGlzdENvbnRhaW5lci5wcmVwZW5kKGNhcmRFbGVtZW50KTtcblxuICAgICAgICBmb3JtLnJlc2V0KCk7XG4gICAgICAgIGNsb3NlTW9kYWwocG9wdXBBZGRDYXJkKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfQntGI0LjQsdC60LAg0LTQvtCx0LDQstC70LXQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuDonLCBlcnJvcik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuXG4gICAgICAgIHNhdmVCdXR0b24udGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LjRgtGMJztcbiAgICAgIH0pO1xuXG4gICAgY2xvc2VNb2RhbChwb3B1cEFkZENhcmQpO1xuICB9LCAxMDAwKVxufSk7XG5cblxuLy/QlNC+0LHQsNCy0LvQtdC90LjQtSDQstGB0LXQvCDQv9C+0L/QsNC/0LDQvCDQutC70LDRgdGB0LAgcG9wdXBfaXMtYW5pbWF0ZWRcbmNvbnN0IGFsbFBvcHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXAnKTtcbmFsbFBvcHMuZm9yRWFjaCgocG9wKSA9PiBwb3AuY2xhc3NMaXN0LmFkZCgncG9wdXBfaXMtYW5pbWF0ZWQnKSlcblxuXG5mb3JtRWRpdEF2YXRhci5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCBhdmF0YXJMaW5rSW5wdXQgPSBldmVudC50YXJnZXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX2F2YXRhci11cmwnKTtcbiAgY29uc3QgYXZhdGFyTGluayA9IGF2YXRhckxpbmtJbnB1dC52YWx1ZTtcbiAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGZvcm1FZGl0QXZhdGFyLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJyk7XG4gIHNhdmVCdXR0b24udGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICB1cGRhdGVBdmF0YXIoYXZhdGFyTGluaylcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgdXNlckF2YXRhci5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7YXZhdGFyTGlua30pYDtcbiAgICAgICAgY2xvc2VNb2RhbChwb3B1cEVkaXRBdmF0YXIpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ9Ce0YjQuNCx0LrQsCDQvtCx0L3QvtCy0LvQtdC90LjRjyDQsNCy0LDRgtCw0YDQsDonLCBlcnJvcik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBzYXZlQnV0dG9uLnRleHRDb250ZW50ID0gJ9Ch0L7RhdGA0LDQvdC40YLRjCc7XG4gICAgICB9KTtcbiAgfSk7XG59LCAxMDAwKVxuIl0sIm5hbWVzIjpbImNvbmZpZyIsImJhc2VVcmwiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiY29uY2F0IiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJjcmVhdGVDYXJkIiwiZGF0YSIsImRlbGV0ZUNhbGxiYWNrIiwidG9vZ2xlSGVhcnRDYWxsYmFjayIsIm9wZW5CaWdJbWFnZUNhbGxiYWNrIiwib3duZXJJZCIsIm5ld0NhcmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2xvbmVOb2RlIiwidGl0bGVDYXJkZWwiLCJxdWVyeVNlbGVjdG9yIiwicGhvdG9DYXJkRWwiLCJ0ZXh0Q29udGVudCIsIm5hbWUiLCJzcmMiLCJsaW5rIiwiYWx0IiwibGlrZUNvdW50RWxlbWVudCIsImxpa2VzIiwibGVuZ3RoIiwibGlrZUhlYXJ0IiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9pZCIsImNhcmRJZCIsIm93bmVyIiwic3R5bGUiLCJkaXNwbGF5IiwidG9vZ2xlSGVhcnQiLCJoZWFydCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiYXBpVXJsIiwibWV0aG9kIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJkZWxldGVMaWtlIiwidXBkYXRlZENhcmQiLCJyZW1vdmUiLCJwb3N0TGlrZSIsImFkZCIsImRlbGV0ZUNhcmQiLCJjYXJkRWxlbWVudCIsInJlc3BvbnNlIiwiRXJyb3IiLCJkZWxldGVDYXJkRnJvbVNlcnZlciIsIm9wZW5Nb2RhbCIsIm1vZGFsIiwia2V5RG93bkhhbmRsZXIiLCJkb2N1bWVudENsaWNrSGFuZGxlciIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJjb2RlIiwiX3JlZiIsInRhcmdldCIsImNsZWFyVmFsaWRhdGlvbiIsImZvcm0iLCJpbnB1dHMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvbiIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZm9yRWFjaCIsImlucHV0IiwiaGlkZUlucHV0RXJyb3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZGlzYWJsZWQiLCJlcnJvckVsZW1lbnQiLCJpZCIsImVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJ0b2dnbGVTdWJtaXRCdXR0b25TdGF0ZSIsImV2ZXJ5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInBvcHVwRWRpdFByb2ZpbGUiLCJwb3B1cEFkZENhcmQiLCJwb3B1cEltZyIsInBvcHVwRWRpdEF2YXRhciIsImZvcm1FZGl0UHJvZmlsZSIsImZvcm1BZGRDYXJkIiwiZm9ybUVkaXRBdmF0YXIiLCJvcGVuRWRpdEJ0blBvcHVwIiwiY2xvc2VCdXR0b25zIiwib3BlbkJ0bkFkZENhcmQiLCJwb3B1cEltYWdlIiwicG9wdXBDYXB0aW9uIiwidXNlckF2YXRhciIsImxpc3RDb250YWluZXIiLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwib3BlbkJpZ0ltYWdlIiwiY2FyZFRpdGxlIiwicmVuZGVyQ2FyZHMiLCJjYXJkcyIsInVzZXJJbmZvIiwiYXBwZW5kQ2hpbGQiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInBhdHRlcm5NaXNtYXRjaCIsImVycm9yTWVzc2FnZSIsImRhdGFzZXQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInZhbHVlIiwidHJpbSIsInNldEN1c3RvbVZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzZXRFdmVudExpc3RlbmVycyIsImVuYWJsZVZhbGlkYXRpb24iLCJidXR0b24iLCJjbG9zZXN0IiwibmFtZUlucHV0IiwicHJvZmlsZU5hbWUiLCJqb2JJbnB1dCIsInByb2ZpbGVKb2IiLCJhbGwiLCJfcmVmMiIsImluaXRpYWxDYXJkcyIsIndpbmRvdyIsImFib3V0IiwiYmFja2dyb3VuZEltYWdlIiwiYXZhdGFyIiwiaW5uZXJIVE1MIiwiZXJyb3JzIiwic2F2ZUJ1dHRvbiIsInNldFRpbWVvdXQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImZpbmFsbHkiLCJyZXNldCIsImZvcm1EYXRhIiwiRm9ybURhdGEiLCJ2YWx1ZXMiLCJPYmplY3QiLCJmcm9tRW50cmllcyIsInZhbHVlTmFtZSIsInZhbHVlVXJsIiwicHJlcGVuZCIsInBvcCIsImF2YXRhckxpbmsiLCJ1cGRhdGVBdmF0YXIiXSwic291cmNlUm9vdCI6IiJ9