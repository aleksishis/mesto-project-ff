(()=>{"use strict";var e={baseUrl:"https://nomoreparties.co/v1/wff-cohort-2",headers:{authorization:"29e47ff3-c405-4d45-9bbb-503bd9191003","Content-Type":"application/json"}},t=function(){return fetch("".concat(e.baseUrl,"/cards"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))};function n(e,t,n,r,o){var c=document.getElementById("card-template").content.firstElementChild.cloneNode(!0),a=c.querySelector(".card__title"),u=c.querySelector(".card__image");a.textContent=e.name,u.src=e.link,u.alt=e.name;var i=c.querySelector(".card__like-count");i.textContent=e.likes.length;var s=c.querySelector(".card__like-button");s.addEventListener("click",(function(){n(s,i,e._id),i.textContent=e.likes.length}));var l=e._id;return o===e.owner._id?c.querySelector(".card__delete-button").addEventListener("click",(function(){t(c,l)})):c.querySelector(".card__delete-button").style.display="none",u.addEventListener("click",(function(){r(c,u)})),c}function r(t,n,r){t.classList.contains("card__like-button_is-active")?function(t){var n="".concat(e.baseUrl,"/cards/likes/").concat(t);return fetch(n,{method:"DELETE",headers:e.headers}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.error("Ошибка снятия лайка:",e)}))}(r).then((function(e){t.classList.remove("card__like-button_is-active"),n.textContent=e.likes.length})):function(t){var n="".concat(e.baseUrl,"/cards/likes/").concat(t);return fetch(n,{method:"PUT",headers:e.headers}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.error("Ошибка постановки лайка:",e)}))}(r).then((function(e){t.classList.add("card__like-button_is-active"),n.textContent=e.likes.length}))}function o(e,t){(function(e){return fetch("https://nomoreparties.co/v1/wff-cohort-2/cards/".concat(e),{method:"DELETE",headers:{authorization:"29e47ff3-c405-4d45-9bbb-503bd9191003"}}).then((function(e){if(e.ok)return e.json();throw new Error("Ошибка: ".concat(e.status))}))})(t).then((function(){e.remove()})).catch((function(e){console.error("Ошибка удаления карточки:",e)}))}function c(e){e.classList.add("popup_is-animated"),e.classList.add("popup_is-opened"),document.addEventListener("keydown",u),document.addEventListener("click",i)}function a(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",u),document.removeEventListener("click",i)}var u=function(e){"Escape"===e.code&&a(document.querySelector(".popup_is-opened"))},i=function(e){var t=e.target;t.classList.contains("popup_is-opened")&&a(t)};function s(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);n.forEach((function(n){l(e,n,t)})),r&&(r.classList.add(t.inactiveButtonClass),r.disabled=!0)}function l(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));r.textContent="",r.classList.remove(n.errorClass),t.classList.remove(n.inputErrorClass)}function d(e,t,n){e.every((function(e){return e.validity.valid}))?(t.classList.remove(n.inactiveButtonClass),t.disabled=!1):(t.classList.add(n.inactiveButtonClass),t.disabled=!0)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=document.querySelector(".popup_type_edit"),_=document.querySelector(".popup_type_new-card"),m=document.querySelector(".popup_type_image"),v=document.querySelector(".popup_type_avatar"),y=f.querySelector(".popup__form"),h=_.querySelector(".popup__form"),b=v.querySelector(".popup__form"),S=document.querySelector(".profile__edit-button"),C=document.querySelectorAll(".popup__close"),q=document.querySelector(".profile__add-button"),E=document.querySelector(".popup__image"),k=document.querySelector(".popup__caption"),L=document.querySelector(".profile__image");L.addEventListener("click",(function(){c(v)}));var g=document.querySelector(".places__list"),x={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function j(e,t){c(m);var n=e.querySelector(".card__title");E.src=t.src,k.textContent=n.textContent,m.src=t.src,m.alt=n.textContent}function A(e,t,r,o){e.forEach((function(e){var c=n(e,t,r,o,userInfo._id);g.appendChild(c)}))}!function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);s(e,t),n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?l(e,t,n):function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));o.textContent=n,o.classList.add(r.errorClass),t.classList.add(r.inputErrorClass)}(e,t,t.validationMessage,n)}(e,o,t),d(n,r,t)}))})),e.addEventListener("reset",(function(){s(e,t)})),d(n,r,t)}(t,e)}))}(x),C.forEach((function(e){e.addEventListener("click",(function(){a(e.closest(".popup"))}))})),S.addEventListener("click",(function(){c(f),w.value=P.textContent,T.value=U.textContent,s(y,x)}));var w=y.querySelector(".popup__input_type_name"),T=y.querySelector(".popup__input_type_description"),P=document.querySelector(".profile__title"),U=document.querySelector(".profile__description");w.value=P.textContent,T.value=U.textContent,Promise.all([fetch("".concat(e.baseUrl,"/users/me"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})),t()]).then((function(e){var n,c,a=(c=2,function(e){if(Array.isArray(e))return e}(n=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,a,u=[],i=!0,s=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=c.call(n)).done)&&(u.push(r.value),u.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(n,c)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(n,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=a[0],i=a[1];return window.userInfo=u,P.textContent=u.name,U.textContent=u.about,L.style.backgroundImage="url(".concat(u.avatar,")"),g.innerHTML="",A(i,o,r,j),t()})).catch((function(e){console.error("Произошла ошибка:",e)})),y.addEventListener("submit",(function(t){t.preventDefault();var n=y.querySelector(".popup__button");n.textContent="Сохранение...",setTimeout((function(){var t,r;(t=w.value,r=T.value,fetch("".concat(e.baseUrl,"/users/me"),{method:"PATCH",headers:e.headers,body:JSON.stringify({name:t,about:r})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){P.textContent=e.name,U.textContent=e.about})).finally((function(){n.textContent="Сохранить"})),a(f),s(y,x)}),1e3)})),q.addEventListener("click",(function(){c(_),h.reset(),s(h,x)})),h.addEventListener("submit",(function(t){t.preventDefault();var c=t.target,u=new FormData(c),i=Object.fromEntries(u),s=i["place-name"],l=i.link,d=h.querySelector(".popup__button");d.textContent="Сохранение...",setTimeout((function(){var t,u;(t=s,u=l,fetch("".concat(e.baseUrl,"/cards"),{method:"POST",headers:e.headers,body:JSON.stringify({name:t,link:u})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){var t=n(e,o,r,j,userInfo._id);g.prepend(t),c.reset(),a(_)})).catch((function(e){console.error("Ошибка добавления карточки:",e)})).finally((function(){d.textContent="Сохранить"})),a(_)}),1e3)})),document.querySelectorAll(".popup").forEach((function(e){return e.classList.add("popup_is-animated")})),b.addEventListener("submit",(function(t){t.preventDefault();var n=t.target.querySelector(".popup__input_type_avatar-url").value,r=b.querySelector(".popup__button");r.textContent="Сохранение...",setTimeout((function(){(function(t){return fetch("".concat(e.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:e.headers,body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))})(n).then((function(){L.style.backgroundImage="url(".concat(n,")"),a(v)})).catch((function(e){console.error("Ошибка обновления аватара:",e)})).finally((function(){r.textContent="Сохранить"}))}))}),1e3)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVcsWUpsR2UsU0FBQ2UsR0FDM0IsT0FBT3hKLE1BQU0sR0FBREMsT0FBSU4sRUFBT0MsUUFBTyxvQkFBb0IsQ0FDaERnRCxPQUFRLFFBRVIvQyxRQUFTRixFQUFPRSxRQUVoQjZJLEtBQU1DLEtBQUtDLFVBQVUsQ0FBRVAsT0FBUW1CLE1BRTlCdEosTUFBSyxTQUFBQyxHQUNKLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5DLFFBQVFDLE9BQU8sV0FBRE4sT0FBWUUsRUFBSUssUUFDdkMsR0FDSixFSXFGSWlKLENBQWFELEdBQ1Z0SixNQUFLLFdBRUpvRyxFQUFXakUsTUFBTStGLGdCQUFrQixPQUFIbkksT0FBVXVKLEVBQVUsS0FDcEQxRixFQUFXK0IsRUFDYixJQUNDaEQsT0FBTSxTQUFBQyxHQUNMQyxRQUFRRCxNQUFNLDZCQUE4QkEsRUFDOUMsSUFDQytGLFNBQVEsV0FFUEwsRUFBV2hILFlBQWMsV0FDM0IsR0FDSixHQUNGLEdBQUcsSSIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvYXBpLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvY2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL21vZGFsLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBiYXNlVXJsOiAnaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3dmZi1jb2hvcnQtMicsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiAnMjllNDdmZjMtYzQwNS00ZDQ1LTliYmItNTAzYmQ5MTkxMDAzJyxcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGdldEluaXRpYWxDYXJkcyA9ICgpID0+IHtcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVyc1xuICB9KVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IGNvbnN0IHVwZGF0ZVVzZXJJbmZvID0gKG5hbWUsIGFib3V0KSA9PiB7XG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgYWJvdXQgfSlcbiAgfSlcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG59XG5cbmV4cG9ydCBjb25zdCBnZXRVc2VySW5mbyA9ICgpID0+IHtcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVyc1xuICB9KVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IGNvbnN0IHBvc3RDYXJkID0gKG5hbWUsIGxpbmspID0+IHtcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBuYW1lLFxuICAgICAgbGlua1xuICAgIH0pXG4gIH0pXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xufVxuXG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZEZyb21TZXJ2ZXIgPSAoY2FyZElkKSA9PiB7XG4gIHJldHVybiBmZXRjaChgaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3dmZi1jb2hvcnQtMi9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICBoZWFkZXJzOiB7XG4gICAgICBhdXRob3JpemF0aW9uOiAnMjllNDdmZjMtYzQwNS00ZDQ1LTliYmItNTAzYmQ5MTkxMDAzJ1xuICAgIH1cbiAgfSlcbiAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBFcnJvcihg0J7RiNC40LHQutCwOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICB9KTtcbn07XG5cblxuZXhwb3J0IGZ1bmN0aW9uIHBvc3RMaWtlKGNhcmRJZCkge1xuICBjb25zdCBhcGlVcmwgPSBgJHtjb25maWcuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YDtcbiAgcmV0dXJuIGZldGNoKGFwaVVybCwge1xuICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnNcbiAgfSlcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKCfQntGI0LjQsdC60LAg0L/QvtGB0YLQsNC90L7QstC60Lgg0LvQsNC50LrQsDonLCBlcnJvcik7XG4gICAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWxldGVMaWtlKGNhcmRJZCkge1xuICBjb25zdCBhcGlVcmwgPSBgJHtjb25maWcuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YDtcbiAgcmV0dXJuIGZldGNoKGFwaVVybCwge1xuICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnNcbiAgfSlcbiAgICAudGhlbihyZXMgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKCfQntGI0LjQsdC60LAg0YHQvdGP0YLQuNGPINC70LDQudC60LA6JywgZXJyb3IpO1xuICAgIH0pO1xufVxuXG5leHBvcnQgY29uc3QgdXBkYXRlQXZhdGFyID0gKGF2YXRhckxpbmspID0+IHtcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgbWV0aG9kOiAnUEFUQ0gnLFxuXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXG5cbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogYXZhdGFyTGluayB9KVxuICB9KVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbn0iLCJcbmltcG9ydCB7IG9wZW5Nb2RhbCB9IGZyb20gXCIuL21vZGFsXCI7XG5pbXBvcnQgeyBwb3B1cEltZyB9IGZyb20gXCIuLlwiO1xuaW1wb3J0IHsgZGVsZXRlQ2FyZEZyb21TZXJ2ZXIsIHBvc3RMaWtlLCBkZWxldGVMaWtlIH0gZnJvbSBcIi4vYXBpXCJcblxuLy8/IEB0b2RvOiDQpNGD0L3QutGG0LjRjyDRgdC+0LfQtNCw0L3QuNGPINC60LDRgNGC0L7Rh9C60LhcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEsIGRlbGV0ZUNhbGxiYWNrLCB0b29nbGVIZWFydENhbGxiYWNrLCBvcGVuQmlnSW1hZ2VDYWxsYmFjaywgb3duZXJJZCkge1xuICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FyZC10ZW1wbGF0ZScpO1xuICBjb25zdCBuZXdDYXJkID0gY2FyZFRlbXBsYXRlLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQuY2xvbmVOb2RlKHRydWUpOyAvLyDQmtC70L7QvdC40YDRg9GOINGI0LDQsdC70L7QvSDQutCw0YDRgtC+0YfQutC4XG4gIC8vINCj0YHRgtCw0L3QsNCy0LvQuNCy0LDRjiDQt9C90LDRh9C10L3QuNGPINCy0LvQvtC20LXQvdC90YvRhSDRjdC70LXQvNC10L3RgtC+0LJcbiAgY29uc3QgdGl0bGVDYXJkZWwgPSBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpXG4gIGNvbnN0IHBob3RvQ2FyZEVsID0gbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuXG4gIHRpdGxlQ2FyZGVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICBwaG90b0NhcmRFbC5zcmMgPSBkYXRhLmxpbms7XG4gIHBob3RvQ2FyZEVsLmFsdCA9IGRhdGEubmFtZTtcblxuICBjb25zdCBsaWtlQ291bnRFbGVtZW50ID0gbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudCcpO1xuICBsaWtlQ291bnRFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5saWtlcy5sZW5ndGg7XG4gIC8v0KDQsNCx0L7RgtCw0Y4g0YEg0LjQutC+0L3QutC+0Lkg0YHQtdGA0LTRhtCwXG4gIGNvbnN0IGxpa2VIZWFydCA9IG5ld0NhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgbGlrZUhlYXJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIHRvb2dsZUhlYXJ0Q2FsbGJhY2sobGlrZUhlYXJ0LCBsaWtlQ291bnRFbGVtZW50LCBkYXRhLl9pZCk7XG4gICAgbGlrZUNvdW50RWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubGlrZXMubGVuZ3RoO1xuICB9KTtcbiAgY29uc3QgY2FyZElkID0gZGF0YS5faWQ7XG5cblxuICAvLyDQlNC+0LHQsNCy0LvRj9C10Lwg0L7QsdGA0LDQsdC+0YLRh9C40Log0LrQu9C40LrQsCDQvdCwINC40LrQvtC90LrRgyDRg9C00LDQu9C10L3QuNGPINGC0L7Qu9GM0LrQviDQtNC70Y8g0LrQsNGA0YLQvtGH0LXQuiwg0YHQvtC30LTQsNC90L3Ri9GFINGC0LXQutGD0YnQuNC8INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvQtdC8XG4gIGlmIChvd25lcklkID09PSBkYXRhLm93bmVyLl9pZCkge1xuICAgIGNvbnN0IGRlbGV0ZUljb24gPSBuZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnV0dG9uJyk7XG4gICAgZGVsZXRlSWNvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGRlbGV0ZUNhbGxiYWNrKG5ld0NhcmQsIGNhcmRJZCk7IC8vINCf0LXRgNC10LTQsNC10LwgRE9NLdGN0LvQtdC80LXQvdGCINC60LDRgNGC0L7Rh9C60Lgg0LIg0LrQvtC70LHRjdC6XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgLy8g0JXRgdC70Lgg0LrQsNGA0YLQvtGH0LrQsCDQvdC1INGB0L7Qt9C00LDQvdCwINGC0LXQutGD0YnQuNC8INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvQtdC8LCDRgdC60YDRi9Cy0LDQtdC8INC40LrQvtC90LrRgyDRg9C00LDQu9C10L3QuNGPXG4gICAgY29uc3QgZGVsZXRlSWNvbiA9IG5ld0NhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKTtcbiAgICBkZWxldGVJY29uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIH1cblxuICAvLyDQlNC+0LHQsNCy0LvRj9C10Lwg0L7QsdGA0LDQsdC+0YLRh9C40Log0LrQu9C40LrQsCDQvdCwINC40LrQvtC90LrRgyDRg9C00LDQu9C10L3QuNGPXG4gIC8vY29uc3QgZGVsZXRlSWNvbiA9IG5ld0NhcmQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKTtcbiAgLy9kZWxldGVJY29uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAvLyAgZGVsZXRlQ2FsbGJhY2sobmV3Q2FyZCk7IC8vINCf0LXRgNC10LTQsNC10LwgRE9NLdGN0LvQtdC80LXQvdGCINC60LDRgNGC0L7Rh9C60Lgg0LIg0LrQvtC70LHRjdC6ICDQuCAgLy8g0JLRi9C30YvQstCw0LXQvCDQv9C10YDQtdC00LDQvdC90YvQuSDQutC+0LvQsdGN0Log0YEg0LjQtNC10L3RgtC40YTQuNC60LDRgtC+0YDQvtC8INC60LDRgNGC0L7Rh9C60LhcbiAgLy99KVxuXG4gIC8vICDQntCi0JrQoNCr0KLQmNCVINCf0J7Qn9CQ0J/QkCDQoSDQmtCQ0KDQotCY0J3QmtCe0JkgXG4gIHBob3RvQ2FyZEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIG9wZW5CaWdJbWFnZUNhbGxiYWNrKG5ld0NhcmQsIHBob3RvQ2FyZEVsKVxuICB9KVxuICByZXR1cm4gbmV3Q2FyZDtcbn1cblxuLy9AdG9kbzog0KTRg9C90LrRhtC40Y8g0L7QsdGA0LDQsdC+0YLQutCwINC70LDQudC60LBcbmV4cG9ydCBmdW5jdGlvbiB0b29nbGVIZWFydChoZWFydCwgbGlrZUNvdW50RWxlbWVudCwgY2FyZElkKSB7XG4gIGNvbnN0IGlzTGlrZWQgPSBoZWFydC5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmVcIik7XG5cblxuXG4gIGlmICghaXNMaWtlZCkge1xuICAgIHBvc3RMaWtlKGNhcmRJZClcbiAgICAgIC50aGVuKHVwZGF0ZWRDYXJkID0+IHtcbiAgICAgICAgaGVhcnQuY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZVwiKTtcbiAgICAgICAgbGlrZUNvdW50RWxlbWVudC50ZXh0Q29udGVudCA9IHVwZGF0ZWRDYXJkLmxpa2VzLmxlbmd0aDtcbiAgICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGRlbGV0ZUxpa2UoY2FyZElkKVxuICAgICAgLnRoZW4odXBkYXRlZENhcmQgPT4ge1xuICAgICAgICBoZWFydC5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlXCIpO1xuICAgICAgICBsaWtlQ291bnRFbGVtZW50LnRleHRDb250ZW50ID0gdXBkYXRlZENhcmQubGlrZXMubGVuZ3RoO1xuICAgICAgfSk7XG4gIH1cbn1cbi8vQHRvZG86INCk0YPQvdC60YbQuNGPINGD0LTQsNC70LXQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuFxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGNhcmRJZCkge1xuICBkZWxldGVDYXJkRnJvbVNlcnZlcihjYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcign0J7RiNC40LHQutCwINGD0LTQsNC70LXQvdC40Y8g0LrQsNGA0YLQvtGH0LrQuDonLCBlcnJvcik7XG4gICAgfSk7XG59XG5cblxuIiwiLy/QpNGD0L3QutGG0LjRjyDQvtGC0LrRgNGL0YLQuNGPINC/0L7Qv9Cw0L/QsFxuZXhwb3J0IGZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9pcy1hbmltYXRlZCcpO1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9pcy1vcGVuZWQnKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGtleURvd25IYW5kbGVyKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkb2N1bWVudENsaWNrSGFuZGxlcik7XG59XG4vL9Ck0YPQvdC60YbQuNGPINC30LDQutGA0YvRgtC40Y8g0L/QvtC/0LDQv9CwXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9pcy1vcGVuZWQnKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGtleURvd25IYW5kbGVyKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkb2N1bWVudENsaWNrSGFuZGxlcik7XG59XG5cbmNvbnN0IGtleURvd25IYW5kbGVyID0gKGV2ZW50KSA9PiB7XG4gIGlmIChldmVudC5jb2RlID09PSBcIkVzY2FwZVwiKSB7XG4gICAgY29uc3Qgb3BlbmVkUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfaXMtb3BlbmVkJyk7XG4gICAgY2xvc2VNb2RhbChvcGVuZWRQb3B1cCk7XG4gIH1cbn1cblxuY29uc3QgZG9jdW1lbnRDbGlja0hhbmRsZXIgPSAoeyB0YXJnZXQgfSkgPT4ge1xuICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfaXMtb3BlbmVkJykpIHtcbiAgICBjbG9zZU1vZGFsKHRhcmdldCk7XG4gIH1cbn0gIiwiXG5leHBvcnQgZnVuY3Rpb24gZW5hYmxlVmFsaWRhdGlvbihjb25maWcpIHtcbiAgY29uc3QgZm9ybXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpO1xuXG4gIGZvcm1zLmZvckVhY2goKGZvcm0pID0+IHtcbiAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybSwgY29uZmlnKTtcbiAgfSk7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVmFsaWRhdGlvbihmb3JtLCBjb25maWcpIHtcbiAgY29uc3QgaW5wdXRzID0gQXJyYXkuZnJvbShmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZm9ybS5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIGlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm0sIGlucHV0LCBjb25maWcpO1xuICB9KTtcbiAgaWYgKHN1Ym1pdEJ1dHRvbikge1xuICAgIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldEV2ZW50TGlzdGVuZXJzKGZvcm0sIGNvbmZpZykge1xuICBjb25zdCBpbnB1dHMgPSBBcnJheS5mcm9tKGZvcm0ucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xuICBjb25zdCBzdWJtaXRCdXR0b24gPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgY2xlYXJWYWxpZGF0aW9uKGZvcm0sIGNvbmZpZylcbiAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybSwgaW5wdXQsIGNvbmZpZyk7XG4gICAgICB0b2dnbGVTdWJtaXRCdXR0b25TdGF0ZShpbnB1dHMsIHN1Ym1pdEJ1dHRvbiwgY29uZmlnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZm9ybS5hZGRFdmVudExpc3RlbmVyKCdyZXNldCcsIGZ1bmN0aW9uICgpIHtcbiAgICBjbGVhclZhbGlkYXRpb24oZm9ybSwgY29uZmlnKTtcbiAgfSk7XG5cbiAgdG9nZ2xlU3VibWl0QnV0dG9uU3RhdGUoaW5wdXRzLCBzdWJtaXRCdXR0b24sIGNvbmZpZyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVja0lucHV0VmFsaWRpdHkoZm9ybSwgaW5wdXQsIGNvbmZpZykge1xuICBpZiAoIWlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybSwgaW5wdXQsIGlucHV0LnZhbGlkYXRpb25NZXNzYWdlLCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm0sIGlucHV0LCBjb25maWcpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaG93SW5wdXRFcnJvcihmb3JtLCBpbnB1dCwgZXJyb3JNZXNzYWdlLCBjb25maWcpIHtcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuZXJyb3JDbGFzcyk7XG4gIGlucHV0LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoaWRlSW5wdXRFcnJvcihmb3JtLCBpbnB1dCwgY29uZmlnKSB7XG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXQuaWR9LWVycm9yYCk7XG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuZXJyb3JDbGFzcyk7XG4gIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59XG5cbmZ1bmN0aW9uIHRvZ2dsZVN1Ym1pdEJ1dHRvblN0YXRlKGlucHV0cywgc3VibWl0QnV0dG9uLCBjb25maWcpIHtcbiAgY29uc3QgaXNWYWxpZCA9IGlucHV0cy5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcblxuICBpZiAoaXNWYWxpZCkge1xuICAgIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgfSBlbHNlIHtcbiAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxufVxuIiwiaW1wb3J0ICcuL3BhZ2VzL2luZGV4LmNzcyc7XG4vL2ltcG9ydCB7IGluaXRpYWxDYXJkcyB9IGZyb20gJy4vY2FyZHMnO1xuaW1wb3J0IHsgY3JlYXRlQ2FyZCwgdG9vZ2xlSGVhcnQsIGRlbGV0ZUNhcmQgfSBmcm9tICcuL2NvbXBvbmVudHMvY2FyZCc7XG5pbXBvcnQgeyBvcGVuTW9kYWwsIGNsb3NlTW9kYWwgfSBmcm9tICcuL2NvbXBvbmVudHMvbW9kYWwnO1xuaW1wb3J0IHsgZW5hYmxlVmFsaWRhdGlvbiwgY2xlYXJWYWxpZGF0aW9uLCBzZXRFdmVudExpc3RlbmVycyB9IGZyb20gJy4vY29tcG9uZW50cy92YWxpZGF0aW9uJztcblxuaW1wb3J0IHsgZ2V0SW5pdGlhbENhcmRzLCB1cGRhdGVVc2VySW5mbywgZ2V0VXNlckluZm8sIHBvc3RDYXJkLCBkZWxldGVDYXJkRnJvbVNlcnZlciwgdXBkYXRlQXZhdGFyIH0gZnJvbSAnLi9jb21wb25lbnRzL2FwaSc7XG5cbi8vQWxsIG1vZGFsIHdpbmRvdy8vXG5jb25zdCBwb3B1cEVkaXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfZWRpdCcpXG5jb25zdCBwb3B1cEFkZENhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9uZXctY2FyZCcpO1xuZXhwb3J0IGNvbnN0IHBvcHVwSW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfaW1hZ2UnKTtcbmNvbnN0IHBvcHVwRWRpdEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2F2YXRhcicpXG5cbi8vQWxsIGZvcm0vL1xuY29uc3QgZm9ybUVkaXRQcm9maWxlID0gcG9wdXBFZGl0UHJvZmlsZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKVxuY29uc3QgZm9ybUFkZENhcmQgPSBwb3B1cEFkZENhcmQucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJylcbmNvbnN0IGZvcm1FZGl0QXZhdGFyID0gcG9wdXBFZGl0QXZhdGFyLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpXG5cbi8vQnV0dG9ucyBvcGVuICYgY2xvc2UvL1xuY29uc3Qgb3BlbkVkaXRCdG5Qb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5jb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2Nsb3NlJyk7XG5jb25zdCBvcGVuQnRuQWRkQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XG5cbmNvbnN0IHBvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XG5jb25zdCBwb3B1cENhcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2NhcHRpb24nKTtcblxuY29uc3QgdXNlckF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19pbWFnZScpO1xuXG51c2VyQXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4geyBvcGVuTW9kYWwocG9wdXBFZGl0QXZhdGFyKSB9KTtcblxuXG5cblxuLy8gQHRvZG86IERPTSDRg9C30LvRi1xuY29uc3QgbGlzdENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZXNfX2xpc3QnKTtcblxuLy9nZXRJbml0aWFsQ2FyZHMoKVxuLy8gIC50aGVuKGNhcmRzID0+IHtcbi8vICAgIGxpc3RDb250YWluZXIuaW5uZXJIVE1MID0gJyc7IC8vINCe0YfQuNGJ0LDQtdC8INC60L7QvdGC0LXQudC90LXRgCDQv9C10YDQtdC0INC30LDQs9GA0YPQt9C60L7QuSDQvdC+0LLRi9GFINC60LDRgNGC0L7Rh9C10Lpcbi8vICAgIHJlbmRlckNhcmRzKGNhcmRzLCBkZWxldGVDYXJkLCB0b29nbGVIZWFydCwgb3BlbkJpZ0ltYWdlKTtcbi8vICB9KVxuLy8gIC5jYXRjaChlcnJvciA9PiB7XG4vLyAgICBjb25zb2xlLmVycm9yKCfQntGI0LjQsdC60LAg0LfQsNCz0YDRg9C30LrQuCDQutCw0YDRgtC+0YfQtdC6INGBINGB0LXRgNCy0LXRgNCwJywgZXJyb3IpO1xuLy8gIH0pO1xuXG5jb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19idXR0b24nLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX2J1dHRvbl9kaXNhYmxlZCcsXG4gIGlucHV0RXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcbiAgZXJyb3JDbGFzczogJ3BvcHVwX19lcnJvcl92aXNpYmxlJ1xufVxuXG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25Db25maWcpO1xuXG5jbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBjbG9zZU1vZGFsKGJ1dHRvbi5jbG9zZXN0KCcucG9wdXAnKSk7XG4gIH0pO1xufSk7XG5cbi8vIEB0b2RvOiDQpNGD0L3QutGG0LjRjyDQvtC60YLRgNGL0YLQuNGPINC/0L7Qv9Cw0L/QsCDQutCw0YDRgtC40L3QutC4XG5mdW5jdGlvbiBvcGVuQmlnSW1hZ2UobmV3Q2FyZCwgcGhvdG9DYXJkRWwpIHtcbiAgb3Blbk1vZGFsKHBvcHVwSW1nKTtcbiAgY29uc3QgY2FyZFRpdGxlID0gbmV3Q2FyZC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKTtcblxuICBwb3B1cEltYWdlLnNyYyA9IHBob3RvQ2FyZEVsLnNyYztcbiAgcG9wdXBDYXB0aW9uLnRleHRDb250ZW50ID0gY2FyZFRpdGxlLnRleHRDb250ZW50O1xuICBwb3B1cEltZy5zcmMgPSBwaG90b0NhcmRFbC5zcmM7XG4gIHBvcHVwSW1nLmFsdCA9IGNhcmRUaXRsZS50ZXh0Q29udGVudDtcbn1cblxuLy8/IEB0b2RvOiDQktGL0LLQtdGB0YLQuCDQutCw0YDRgtC+0YfQutC4INC90LAg0YHRgtGA0LDQvdC40YbRg1xuXG5mdW5jdGlvbiByZW5kZXJDYXJkcyhjYXJkcywgZGVsZXRlQ2FsbGJhY2ssIHRvb2dsZUhlYXJ0Q2FsbGJhY2ssIG9wZW5CaWdJbWFnZUNhbGxiYWNrKSB7XG4gIC8vINCh0L7Qt9C00LDQtdC8INC4INC00L7QsdCw0LLQu9GP0LXQvCDQutCw0YDRgtC+0YfQutC4INCyINC60L7QvdGC0LXQudC90LXRgFxuICBjYXJkcy5mb3JFYWNoKGRhdGEgPT4ge1xuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChkYXRhLCBkZWxldGVDYWxsYmFjaywgdG9vZ2xlSGVhcnRDYWxsYmFjaywgb3BlbkJpZ0ltYWdlQ2FsbGJhY2ssIHVzZXJJbmZvLl9pZCk7XG4gICAgbGlzdENvbnRhaW5lci5hcHBlbmRDaGlsZChjYXJkRWxlbWVudCk7XG4gIH0pO1xufVxuLy8/INCe0YLQutGA0YvRgtC40LUg0Lgg0LfQsNC60YDRi9GC0LjQtSDQv9C+0L/QsNC/0LAgcG9wdXBFZGl0UHJvZmlsZVxub3BlbkVkaXRCdG5Qb3B1cC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgb3Blbk1vZGFsKHBvcHVwRWRpdFByb2ZpbGUpO1xuICBuYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbiAgam9iSW5wdXQudmFsdWUgPSBwcm9maWxlSm9iLnRleHRDb250ZW50O1xuICAvL3NldEV2ZW50TGlzdGVuZXJzKGZvcm1FZGl0UHJvZmlsZSwgdmFsaWRhdGlvbkNvbmZpZyk7XG4gIGNsZWFyVmFsaWRhdGlvbihmb3JtRWRpdFByb2ZpbGUsIHZhbGlkYXRpb25Db25maWcpIC8vINGB0LTQtdC70LDRgtGMINGC0LDQuiwg0YfRgtC+0LHRi9C/XG59KTtcblxuLy8/INCd0LDRhdC+0LTQuNC8INC/0L7Qu9GPINGE0L7RgNC80Ysg0LIgRE9NXG5jb25zdCBuYW1lSW5wdXQgPSBmb3JtRWRpdFByb2ZpbGUucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX25hbWUnKTtcbmNvbnN0IGpvYklucHV0ID0gZm9ybUVkaXRQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9kZXNjcmlwdGlvbicpO1xuXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5jb25zdCBwcm9maWxlSm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKVxuXG5uYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbmpvYklucHV0LnZhbHVlID0gcHJvZmlsZUpvYi50ZXh0Q29udGVudDtcblxuXG5cblByb21pc2UuYWxsKFtnZXRVc2VySW5mbygpLCBnZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC50aGVuKChbdXNlckluZm8sIGluaXRpYWxDYXJkc10pID0+IHtcbiAgICAvLyDQl9C00LXRgdGMINC80L7QttC90L4g0LLRi9C/0L7Qu9C90Y/RgtGMINC00L7Qv9C+0LvQvdC40YLQtdC70YzQvdGL0LUg0LTQtdC50YHRgtCy0LjRjyDRgSDQv9C+0LvRg9GH0LXQvdC90YvQvNC4INC00LDQvdC90YvQvNC4LCDQtdGB0LvQuCDQvdC10L7QsdGF0L7QtNC40LzQvlxuICAgIHdpbmRvdy51c2VySW5mbyA9IHVzZXJJbmZvO1xuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckluZm8ubmFtZTtcbiAgICBwcm9maWxlSm9iLnRleHRDb250ZW50ID0gdXNlckluZm8uYWJvdXQ7XG5cbiAgICB1c2VyQXZhdGFyLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHt1c2VySW5mby5hdmF0YXJ9KWA7XG5cbiAgICAvLyDQntGH0LjRidCw0LXQvCDQutC+0L3RgtC10LnQvdC10YAg0L/QtdGA0LXQtCDQt9Cw0LPRgNGD0LfQutC+0Lkg0L3QvtCy0YvRhSDQutCw0YDRgtC+0YfQtdC6XG4gICAgbGlzdENvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcblxuICAgIC8vINCg0LXQvdC00LXRgNC40Lwg0LrQsNGA0YLQvtGH0LrQuFxuICAgIHJlbmRlckNhcmRzKGluaXRpYWxDYXJkcywgZGVsZXRlQ2FyZCwgdG9vZ2xlSGVhcnQsIG9wZW5CaWdJbWFnZSk7XG4gICAgcmV0dXJuIGdldEluaXRpYWxDYXJkcygpXG4gIH0pXG4gIC5jYXRjaChlcnJvcnMgPT4ge1xuICAgIGNvbnNvbGUuZXJyb3IoJ9Cf0YDQvtC40LfQvtGI0LvQsCDQvtGI0LjQsdC60LA6JywgZXJyb3JzKTtcbiAgfSk7XG5cbi8vZ2V0VXNlckluZm8oKVxuLy8gIC50aGVuKCh1c2VySW5mbykgPT4ge1xuLy8gICAgd2luZG93LnVzZXJJbmZvID0gdXNlckluZm87XG4vLyAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXJJbmZvLm5hbWU7XG4vLyAgICBwcm9maWxlSm9iLnRleHRDb250ZW50ID0gdXNlckluZm8uYWJvdXQ7XG4vLyAgICB1c2VyQXZhdGFyLnVybCA9IHVzZXJJbmZvLmF2YXRhcjtcbi8vICAgIHJldHVybiBnZXRJbml0aWFsQ2FyZHMoKVxuLy8gIH0pXG5cbmZvcm1FZGl0UHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBmdW5jdGlvbiAoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBzYXZlQnV0dG9uID0gZm9ybUVkaXRQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJyk7XG4gIHNhdmVCdXR0b24udGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xuXG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIHVwZGF0ZVVzZXJJbmZvKG5hbWVJbnB1dC52YWx1ZSwgam9iSW5wdXQudmFsdWUpXG4gICAgICAudGhlbigodXNlckluZm8pID0+IHtcbiAgICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VySW5mby5uYW1lO1xuICAgICAgICBwcm9maWxlSm9iLnRleHRDb250ZW50ID0gdXNlckluZm8uYWJvdXQ7XG5cbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIC8vINCY0YHRhdC+0LTQvdGL0Lkg0YLQtdC60YHRgiDQutC90L7Qv9C60Lgg0L/QvtGB0LvQtSDQt9Cw0LLQtdGA0YjQtdC90LjRjyDQt9Cw0L/RgNC+0YHQsFxuICAgICAgICBzYXZlQnV0dG9uLnRleHRDb250ZW50ID0gJ9Ch0L7RhdGA0LDQvdC40YLRjCc7XG4gICAgICB9KTtcblxuICAgIGNsb3NlTW9kYWwocG9wdXBFZGl0UHJvZmlsZSk7XG5cbiAgICBjbGVhclZhbGlkYXRpb24oZm9ybUVkaXRQcm9maWxlLCB2YWxpZGF0aW9uQ29uZmlnKTtcbiAgfSwgMTAwMCk7XG59KTtcblxuXG5vcGVuQnRuQWRkQ2FyZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgb3Blbk1vZGFsKHBvcHVwQWRkQ2FyZCk7XG4gIGZvcm1BZGRDYXJkLnJlc2V0KCk7XG5cbiAgY2xlYXJWYWxpZGF0aW9uKGZvcm1BZGRDYXJkLCB2YWxpZGF0aW9uQ29uZmlnKTtcbn0pXG5cbmZvcm1BZGRDYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGZ1bmN0aW9uIChldmVudCkge1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBmb3JtID0gZXZlbnQudGFyZ2V0O1xuICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YShmb3JtKTtcbiAgY29uc3QgdmFsdWVzID0gT2JqZWN0LmZyb21FbnRyaWVzKGZvcm1EYXRhKTtcbiAgY29uc3QgdmFsdWVOYW1lID0gdmFsdWVzWydwbGFjZS1uYW1lJ107XG4gIGNvbnN0IHZhbHVlVXJsID0gdmFsdWVzWydsaW5rJ107XG5cbiAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGZvcm1BZGRDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJyk7XG4gIHNhdmVCdXR0b24udGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nO1xuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICBwb3N0Q2FyZCh2YWx1ZU5hbWUsIHZhbHVlVXJsKVxuICAgICAgLnRoZW4obmV3Q2FyZCA9PiB7XG4gICAgICAgIC8vINCe0LHQvdC+0LLQu9C10L3QuNC1INC40L3RgtC10YDRhNC10LnRgdCwINGBINC00L7QsdCw0LLQu9C10L3QuNC10Lwg0L3QvtCy0L7QuSDQutCw0YDRgtC+0YfQutC4XG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChuZXdDYXJkLCBkZWxldGVDYXJkLCB0b29nbGVIZWFydCwgb3BlbkJpZ0ltYWdlLCB1c2VySW5mby5faWQpO1xuICAgICAgICBsaXN0Q29udGFpbmVyLnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuXG4gICAgICAgIGZvcm0ucmVzZXQoKTtcbiAgICAgICAgY2xvc2VNb2RhbChwb3B1cEFkZENhcmQpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ9Ce0YjQuNCx0LrQsCDQtNC+0LHQsNCy0LvQtdC90LjRjyDQutCw0YDRgtC+0YfQutC4OicsIGVycm9yKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIC8vINCY0YHRhdC+0LTQvdGL0Lkg0YLQtdC60YHRgiDQutC90L7Qv9C60Lgg0L/QvtGB0LvQtSDQt9Cw0LLQtdGA0YjQtdC90LjRjyDQt9Cw0L/RgNC+0YHQsFxuICAgICAgICBzYXZlQnV0dG9uLnRleHRDb250ZW50ID0gJ9Ch0L7RhdGA0LDQvdC40YLRjCc7XG4gICAgICB9KTtcblxuICAgIGNsb3NlTW9kYWwocG9wdXBBZGRDYXJkKTtcbiAgfSwgMTAwMClcbn0pO1xuXG5cbi8v0JTQvtCx0LDQstC70LXQvdC40LUg0LLRgdC10Lwg0L/QvtC/0LDQv9Cw0Lwg0LrQu9Cw0YHRgdCwIHBvcHVwX2lzLWFuaW1hdGVkXG5jb25zdCBhbGxQb3BzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwJyk7XG5hbGxQb3BzLmZvckVhY2goKHBvcCkgPT4gcG9wLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX2lzLWFuaW1hdGVkJykpXG5cblxuZm9ybUVkaXRBdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3QgYXZhdGFyTGlua0lucHV0ID0gZXZlbnQudGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9hdmF0YXItdXJsJyk7XG4gIGNvbnN0IGF2YXRhckxpbmsgPSBhdmF0YXJMaW5rSW5wdXQudmFsdWU7XG4gIGNvbnN0IHNhdmVCdXR0b24gPSBmb3JtRWRpdEF2YXRhci5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbicpO1xuICBzYXZlQnV0dG9uLnRleHRDb250ZW50ID0gJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJztcbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgdXBkYXRlQXZhdGFyKGF2YXRhckxpbmspXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIC8vINCe0LHQvdC+0LLQuNGC0LUg0LDQstCw0YLQsNGAINC90LAg0YHRgtGA0LDQvdC40YbQtVxuICAgICAgICB1c2VyQXZhdGFyLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHthdmF0YXJMaW5rfSlgO1xuICAgICAgICBjbG9zZU1vZGFsKHBvcHVwRWRpdEF2YXRhcik7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcign0J7RiNC40LHQutCwINC+0LHQvdC+0LLQu9C10L3QuNGPINCw0LLQsNGC0LDRgNCwOicsIGVycm9yKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIC8vINCY0YHRhdC+0LTQvdGL0Lkg0YLQtdC60YHRgiDQutC90L7Qv9C60Lgg0L/QvtGB0LvQtSDQt9Cw0LLQtdGA0YjQtdC90LjRjyDQt9Cw0L/RgNC+0YHQsFxuICAgICAgICBzYXZlQnV0dG9uLnRleHRDb250ZW50ID0gJ9Ch0L7RhdGA0LDQvdC40YLRjCc7XG4gICAgICB9KTtcbiAgfSk7XG59LCAxMDAwKVxuIl0sIm5hbWVzIjpbImNvbmZpZyIsImJhc2VVcmwiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiY29uY2F0IiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJjcmVhdGVDYXJkIiwiZGF0YSIsImRlbGV0ZUNhbGxiYWNrIiwidG9vZ2xlSGVhcnRDYWxsYmFjayIsIm9wZW5CaWdJbWFnZUNhbGxiYWNrIiwib3duZXJJZCIsIm5ld0NhcmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2xvbmVOb2RlIiwidGl0bGVDYXJkZWwiLCJxdWVyeVNlbGVjdG9yIiwicGhvdG9DYXJkRWwiLCJ0ZXh0Q29udGVudCIsIm5hbWUiLCJzcmMiLCJsaW5rIiwiYWx0IiwibGlrZUNvdW50RWxlbWVudCIsImxpa2VzIiwibGVuZ3RoIiwibGlrZUhlYXJ0IiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9pZCIsImNhcmRJZCIsIm93bmVyIiwic3R5bGUiLCJkaXNwbGF5IiwidG9vZ2xlSGVhcnQiLCJoZWFydCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiYXBpVXJsIiwibWV0aG9kIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJkZWxldGVMaWtlIiwidXBkYXRlZENhcmQiLCJyZW1vdmUiLCJwb3N0TGlrZSIsImFkZCIsImRlbGV0ZUNhcmQiLCJjYXJkRWxlbWVudCIsInJlc3BvbnNlIiwiRXJyb3IiLCJkZWxldGVDYXJkRnJvbVNlcnZlciIsIm9wZW5Nb2RhbCIsIm1vZGFsIiwia2V5RG93bkhhbmRsZXIiLCJkb2N1bWVudENsaWNrSGFuZGxlciIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJjb2RlIiwiX3JlZiIsInRhcmdldCIsImNsZWFyVmFsaWRhdGlvbiIsImZvcm0iLCJpbnB1dHMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvbiIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZm9yRWFjaCIsImlucHV0IiwiaGlkZUlucHV0RXJyb3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZGlzYWJsZWQiLCJlcnJvckVsZW1lbnQiLCJpZCIsImVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJ0b2dnbGVTdWJtaXRCdXR0b25TdGF0ZSIsImV2ZXJ5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInBvcHVwRWRpdFByb2ZpbGUiLCJwb3B1cEFkZENhcmQiLCJwb3B1cEltZyIsInBvcHVwRWRpdEF2YXRhciIsImZvcm1FZGl0UHJvZmlsZSIsImZvcm1BZGRDYXJkIiwiZm9ybUVkaXRBdmF0YXIiLCJvcGVuRWRpdEJ0blBvcHVwIiwiY2xvc2VCdXR0b25zIiwib3BlbkJ0bkFkZENhcmQiLCJwb3B1cEltYWdlIiwicG9wdXBDYXB0aW9uIiwidXNlckF2YXRhciIsImxpc3RDb250YWluZXIiLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwib3BlbkJpZ0ltYWdlIiwiY2FyZFRpdGxlIiwicmVuZGVyQ2FyZHMiLCJjYXJkcyIsInVzZXJJbmZvIiwiYXBwZW5kQ2hpbGQiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsImVycm9yTWVzc2FnZSIsInNob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzZXRFdmVudExpc3RlbmVycyIsImVuYWJsZVZhbGlkYXRpb24iLCJidXR0b24iLCJjbG9zZXN0IiwibmFtZUlucHV0IiwidmFsdWUiLCJwcm9maWxlTmFtZSIsImpvYklucHV0IiwicHJvZmlsZUpvYiIsImFsbCIsIl9yZWYyIiwiaW5pdGlhbENhcmRzIiwid2luZG93IiwiYWJvdXQiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJhdmF0YXIiLCJpbm5lckhUTUwiLCJlcnJvcnMiLCJzYXZlQnV0dG9uIiwic2V0VGltZW91dCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZmluYWxseSIsInJlc2V0IiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsInZhbHVlcyIsIk9iamVjdCIsImZyb21FbnRyaWVzIiwidmFsdWVOYW1lIiwidmFsdWVVcmwiLCJwcmVwZW5kIiwicG9wIiwiYXZhdGFyTGluayIsInVwZGF0ZUF2YXRhciJdLCJzb3VyY2VSb290IjoiIn0=